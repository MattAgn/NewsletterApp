5ccfe9784bb75896435060d32593e265
/** @license React v0.14.0
 * scheduler-tracing.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
'use strict';

if (process.env.NODE_ENV !== "production") {
  (function () {
    'use strict';

    Object.defineProperty(exports, '__esModule', {
      value: true
    });
    var enableSchedulerTracing = true;
    var DEFAULT_THREAD_ID = 0;
    var interactionIDCounter = 0;
    var threadIDCounter = 0;
    exports.__interactionsRef = null;
    exports.__subscriberRef = null;

    if (enableSchedulerTracing) {
      exports.__interactionsRef = {
        current: new Set()
      };
      exports.__subscriberRef = {
        current: null
      };
    }

    function unstable_clear(callback) {
      if (!enableSchedulerTracing) {
        return callback();
      }

      var prevInteractions = exports.__interactionsRef.current;
      exports.__interactionsRef.current = new Set();

      try {
        return callback();
      } finally {
        exports.__interactionsRef.current = prevInteractions;
      }
    }

    function unstable_getCurrent() {
      if (!enableSchedulerTracing) {
        return null;
      } else {
        return exports.__interactionsRef.current;
      }
    }

    function unstable_getThreadID() {
      return ++threadIDCounter;
    }

    function unstable_trace(name, timestamp, callback) {
      var threadID = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : DEFAULT_THREAD_ID;

      if (!enableSchedulerTracing) {
        return callback();
      }

      var interaction = {
        __count: 1,
        id: interactionIDCounter++,
        name: name,
        timestamp: timestamp
      };
      var prevInteractions = exports.__interactionsRef.current;
      var interactions = new Set(prevInteractions);
      interactions.add(interaction);
      exports.__interactionsRef.current = interactions;
      var subscriber = exports.__subscriberRef.current;
      var returnValue = void 0;

      try {
        if (subscriber !== null) {
          subscriber.onInteractionTraced(interaction);
        }
      } finally {
        try {
          if (subscriber !== null) {
            subscriber.onWorkStarted(interactions, threadID);
          }
        } finally {
          try {
            returnValue = callback();
          } finally {
            exports.__interactionsRef.current = prevInteractions;

            try {
              if (subscriber !== null) {
                subscriber.onWorkStopped(interactions, threadID);
              }
            } finally {
              interaction.__count--;

              if (subscriber !== null && interaction.__count === 0) {
                subscriber.onInteractionScheduledWorkCompleted(interaction);
              }
            }
          }
        }
      }

      return returnValue;
    }

    function unstable_wrap(callback) {
      var threadID = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DEFAULT_THREAD_ID;

      if (!enableSchedulerTracing) {
        return callback;
      }

      var wrappedInteractions = exports.__interactionsRef.current;
      var subscriber = exports.__subscriberRef.current;

      if (subscriber !== null) {
        subscriber.onWorkScheduled(wrappedInteractions, threadID);
      }

      wrappedInteractions.forEach(function (interaction) {
        interaction.__count++;
      });
      var hasRun = false;

      function wrapped() {
        var prevInteractions = exports.__interactionsRef.current;
        exports.__interactionsRef.current = wrappedInteractions;
        subscriber = exports.__subscriberRef.current;

        try {
          var returnValue = void 0;

          try {
            if (subscriber !== null) {
              subscriber.onWorkStarted(wrappedInteractions, threadID);
            }
          } finally {
            try {
              returnValue = callback.apply(undefined, arguments);
            } finally {
              exports.__interactionsRef.current = prevInteractions;

              if (subscriber !== null) {
                subscriber.onWorkStopped(wrappedInteractions, threadID);
              }
            }
          }

          return returnValue;
        } finally {
          if (!hasRun) {
            hasRun = true;
            wrappedInteractions.forEach(function (interaction) {
              interaction.__count--;

              if (subscriber !== null && interaction.__count === 0) {
                subscriber.onInteractionScheduledWorkCompleted(interaction);
              }
            });
          }
        }
      }

      wrapped.cancel = function cancel() {
        subscriber = exports.__subscriberRef.current;

        try {
          if (subscriber !== null) {
            subscriber.onWorkCanceled(wrappedInteractions, threadID);
          }
        } finally {
          wrappedInteractions.forEach(function (interaction) {
            interaction.__count--;

            if (subscriber && interaction.__count === 0) {
              subscriber.onInteractionScheduledWorkCompleted(interaction);
            }
          });
        }
      };

      return wrapped;
    }

    var subscribers = null;

    if (enableSchedulerTracing) {
      subscribers = new Set();
    }

    function unstable_subscribe(subscriber) {
      if (enableSchedulerTracing) {
        subscribers.add(subscriber);

        if (subscribers.size === 1) {
          exports.__subscriberRef.current = {
            onInteractionScheduledWorkCompleted: onInteractionScheduledWorkCompleted,
            onInteractionTraced: onInteractionTraced,
            onWorkCanceled: onWorkCanceled,
            onWorkScheduled: onWorkScheduled,
            onWorkStarted: onWorkStarted,
            onWorkStopped: onWorkStopped
          };
        }
      }
    }

    function unstable_unsubscribe(subscriber) {
      if (enableSchedulerTracing) {
        subscribers.delete(subscriber);

        if (subscribers.size === 0) {
          exports.__subscriberRef.current = null;
        }
      }
    }

    function onInteractionTraced(interaction) {
      var didCatchError = false;
      var caughtError = null;
      subscribers.forEach(function (subscriber) {
        try {
          subscriber.onInteractionTraced(interaction);
        } catch (error) {
          if (!didCatchError) {
            didCatchError = true;
            caughtError = error;
          }
        }
      });

      if (didCatchError) {
        throw caughtError;
      }
    }

    function onInteractionScheduledWorkCompleted(interaction) {
      var didCatchError = false;
      var caughtError = null;
      subscribers.forEach(function (subscriber) {
        try {
          subscriber.onInteractionScheduledWorkCompleted(interaction);
        } catch (error) {
          if (!didCatchError) {
            didCatchError = true;
            caughtError = error;
          }
        }
      });

      if (didCatchError) {
        throw caughtError;
      }
    }

    function onWorkScheduled(interactions, threadID) {
      var didCatchError = false;
      var caughtError = null;
      subscribers.forEach(function (subscriber) {
        try {
          subscriber.onWorkScheduled(interactions, threadID);
        } catch (error) {
          if (!didCatchError) {
            didCatchError = true;
            caughtError = error;
          }
        }
      });

      if (didCatchError) {
        throw caughtError;
      }
    }

    function onWorkStarted(interactions, threadID) {
      var didCatchError = false;
      var caughtError = null;
      subscribers.forEach(function (subscriber) {
        try {
          subscriber.onWorkStarted(interactions, threadID);
        } catch (error) {
          if (!didCatchError) {
            didCatchError = true;
            caughtError = error;
          }
        }
      });

      if (didCatchError) {
        throw caughtError;
      }
    }

    function onWorkStopped(interactions, threadID) {
      var didCatchError = false;
      var caughtError = null;
      subscribers.forEach(function (subscriber) {
        try {
          subscriber.onWorkStopped(interactions, threadID);
        } catch (error) {
          if (!didCatchError) {
            didCatchError = true;
            caughtError = error;
          }
        }
      });

      if (didCatchError) {
        throw caughtError;
      }
    }

    function onWorkCanceled(interactions, threadID) {
      var didCatchError = false;
      var caughtError = null;
      subscribers.forEach(function (subscriber) {
        try {
          subscriber.onWorkCanceled(interactions, threadID);
        } catch (error) {
          if (!didCatchError) {
            didCatchError = true;
            caughtError = error;
          }
        }
      });

      if (didCatchError) {
        throw caughtError;
      }
    }

    exports.unstable_clear = unstable_clear;
    exports.unstable_getCurrent = unstable_getCurrent;
    exports.unstable_getThreadID = unstable_getThreadID;
    exports.unstable_trace = unstable_trace;
    exports.unstable_wrap = unstable_wrap;
    exports.unstable_subscribe = unstable_subscribe;
    exports.unstable_unsubscribe = unstable_unsubscribe;
  })();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjaGVkdWxlci10cmFjaW5nLmRldmVsb3BtZW50LmpzIl0sIm5hbWVzIjpbInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiZW5hYmxlU2NoZWR1bGVyVHJhY2luZyIsIkRFRkFVTFRfVEhSRUFEX0lEIiwiaW50ZXJhY3Rpb25JRENvdW50ZXIiLCJ0aHJlYWRJRENvdW50ZXIiLCJfX2ludGVyYWN0aW9uc1JlZiIsIl9fc3Vic2NyaWJlclJlZiIsImN1cnJlbnQiLCJTZXQiLCJ1bnN0YWJsZV9jbGVhciIsImNhbGxiYWNrIiwicHJldkludGVyYWN0aW9ucyIsInVuc3RhYmxlX2dldEN1cnJlbnQiLCJ1bnN0YWJsZV9nZXRUaHJlYWRJRCIsInVuc3RhYmxlX3RyYWNlIiwibmFtZSIsInRpbWVzdGFtcCIsInRocmVhZElEIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiaW50ZXJhY3Rpb24iLCJfX2NvdW50IiwiaWQiLCJpbnRlcmFjdGlvbnMiLCJhZGQiLCJzdWJzY3JpYmVyIiwicmV0dXJuVmFsdWUiLCJvbkludGVyYWN0aW9uVHJhY2VkIiwib25Xb3JrU3RhcnRlZCIsIm9uV29ya1N0b3BwZWQiLCJvbkludGVyYWN0aW9uU2NoZWR1bGVkV29ya0NvbXBsZXRlZCIsInVuc3RhYmxlX3dyYXAiLCJ3cmFwcGVkSW50ZXJhY3Rpb25zIiwib25Xb3JrU2NoZWR1bGVkIiwiZm9yRWFjaCIsImhhc1J1biIsIndyYXBwZWQiLCJhcHBseSIsImNhbmNlbCIsIm9uV29ya0NhbmNlbGVkIiwic3Vic2NyaWJlcnMiLCJ1bnN0YWJsZV9zdWJzY3JpYmUiLCJzaXplIiwidW5zdGFibGVfdW5zdWJzY3JpYmUiLCJkZWxldGUiLCJkaWRDYXRjaEVycm9yIiwiY2F1Z2h0RXJyb3IiLCJlcnJvciJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7O0FBU0E7O0FBSUEsSUFBSUEsT0FBTyxD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VUFBVixFQUFzQjtBQUN4QyxZQUFJO0FBQ0ZBLFVBQUFBLFVBQVUsQ0FBQ2MsY0FBWCxDQUEwQmhCLFlBQTFCLEVBQXdDUCxRQUF4QztBQUNELFNBRkQsQ0FFRSxPQUFPK0IsS0FBUCxFQUFjO0FBQ2QsY0FBSSxDQUFDRixhQUFMLEVBQW9CO0FBQ2xCQSxZQUFBQSxhQUFhLEdBQUcsSUFBaEI7QUFDQUMsWUFBQUEsV0FBVyxHQUFHQyxLQUFkO0FBQ0Q7QUFDRjtBQUNGLE9BVEQ7O0FBV0EsVUFBSUYsYUFBSixFQUFtQjtBQUNqQixjQUFNQyxXQUFOO0FBQ0Q7QUFDRjs7QUFFRGhELElBQUFBLE9BQU8sQ0FBQ1UsY0FBUixHQUF5QkEsY0FBekI7QUFDQVYsSUFBQUEsT0FBTyxDQUFDYSxtQkFBUixHQUE4QkEsbUJBQTlCO0FBQ0FiLElBQUFBLE9BQU8sQ0FBQ2Msb0JBQVIsR0FBK0JBLG9CQUEvQjtBQUNBZCxJQUFBQSxPQUFPLENBQUNlLGNBQVIsR0FBeUJBLGNBQXpCO0FBQ0FmLElBQUFBLE9BQU8sQ0FBQ2lDLGFBQVIsR0FBd0JBLGFBQXhCO0FBQ0FqQyxJQUFBQSxPQUFPLENBQUMyQyxrQkFBUixHQUE2QkEsa0JBQTdCO0FBQ0EzQyxJQUFBQSxPQUFPLENBQUM2QyxvQkFBUixHQUErQkEsb0JBQS9CO0FBQ0csR0E3YUQ7QUE4YUQiLCJzb3VyY2VzQ29udGVudCI6WyIvKiogQGxpY2Vuc2UgUmVhY3QgdjAuMTQuMFxuICogc2NoZWR1bGVyLXRyYWNpbmcuZGV2ZWxvcG1lbnQuanNcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cblxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gIChmdW5jdGlvbigpIHtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcblxuLy8gSGVscHMgaWRlbnRpZnkgc2lkZSBlZmZlY3RzIGluIGJlZ2luLXBoYXNlIGxpZmVjeWNsZSBob29rcyBhbmQgc2V0U3RhdGUgcmVkdWNlcnM6XG5cblxuLy8gSW4gc29tZSBjYXNlcywgU3RyaWN0TW9kZSBzaG91bGQgYWxzbyBkb3VibGUtcmVuZGVyIGxpZmVjeWNsZXMuXG4vLyBUaGlzIGNhbiBiZSBjb25mdXNpbmcgZm9yIHRlc3RzIHRob3VnaCxcbi8vIEFuZCBpdCBjYW4gYmUgYmFkIGZvciBwZXJmb3JtYW5jZSBpbiBwcm9kdWN0aW9uLlxuLy8gVGhpcyBmZWF0dXJlIGZsYWcgY2FuIGJlIHVzZWQgdG8gY29udHJvbCB0aGUgYmVoYXZpb3I6XG5cblxuLy8gVG8gcHJlc2VydmUgdGhlIFwiUGF1c2Ugb24gY2F1Z2h0IGV4Y2VwdGlvbnNcIiBiZWhhdmlvciBvZiB0aGUgZGVidWdnZXIsIHdlXG4vLyByZXBsYXkgdGhlIGJlZ2luIHBoYXNlIG9mIGEgZmFpbGVkIGNvbXBvbmVudCBpbnNpZGUgaW52b2tlR3VhcmRlZENhbGxiYWNrLlxuXG5cbi8vIFdhcm4gYWJvdXQgZGVwcmVjYXRlZCwgYXN5bmMtdW5zYWZlIGxpZmVjeWNsZXM7IHJlbGF0ZXMgdG8gUkZDICM2OlxuXG5cbi8vIEdhdGhlciBhZHZhbmNlZCB0aW1pbmcgbWV0cmljcyBmb3IgUHJvZmlsZXIgc3VidHJlZXMuXG5cblxuLy8gVHJhY2Ugd2hpY2ggaW50ZXJhY3Rpb25zIHRyaWdnZXIgZWFjaCBjb21taXQuXG52YXIgZW5hYmxlU2NoZWR1bGVyVHJhY2luZyA9IHRydWU7XG5cbi8vIE9ubHkgdXNlZCBpbiB3d3cgYnVpbGRzLlxuIC8vIFRPRE86IHRydWU/IEhlcmUgaXQgbWlnaHQganVzdCBiZSBmYWxzZS5cblxuLy8gT25seSB1c2VkIGluIHd3dyBidWlsZHMuXG5cblxuLy8gT25seSB1c2VkIGluIHd3dyBidWlsZHMuXG5cblxuLy8gRGlzYWJsZSBqYXZhc2NyaXB0OiBVUkwgc3RyaW5ncyBpbiBocmVmIGZvciBYU1MgcHJvdGVjdGlvbi5cblxuXG4vLyBEaXNhYmxlcyB5aWVsZGluZyBkdXJpbmcgcmVuZGVyIGluIENvbmN1cnJlbnQgTW9kZS4gVXNlZCBmb3IgZGVidWdnaW5nIG9ubHkuXG5cblxuLy8gUmVhY3QgRmlyZTogcHJldmVudCB0aGUgdmFsdWUgYW5kIGNoZWNrZWQgYXR0cmlidXRlcyBmcm9tIHN5bmNpbmdcbi8vIHdpdGggdGhlaXIgcmVsYXRlZCBET00gcHJvcGVydGllc1xuXG5cbi8vIFRoZXNlIEFQSXMgd2lsbCBubyBsb25nZXIgYmUgXCJ1bnN0YWJsZVwiIGluIHRoZSB1cGNvbWluZyAxNi43IHJlbGVhc2UsXG4vLyBDb250cm9sIHRoaXMgYmVoYXZpb3Igd2l0aCBhIGZsYWcgdG8gc3VwcG9ydCAxNi42IG1pbm9yIHJlbGVhc2VzIGluIHRoZSBtZWFud2hpbGUuXG5cblxuXG5cbi8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vcmVhY3QtbmF0aXZlLWNvbW11bml0eS9kaXNjdXNzaW9ucy1hbmQtcHJvcG9zYWxzL2lzc3Vlcy83MiBmb3IgbW9yZSBpbmZvcm1hdGlvblxuLy8gVGhpcyBpcyBhIGZsYWcgc28gd2UgY2FuIGZpeCB3YXJuaW5ncyBpbiBSTiBjb3JlIGJlZm9yZSB0dXJuaW5nIGl0IG9uXG5cblxuLy8gRXhwZXJpbWVudGFsIFJlYWN0IEV2ZW50cyBzdXBwb3J0LiBPbmx5IHVzZWQgaW4gd3d3IGJ1aWxkcyBmb3Igbm93LlxuXG5cbi8vIEVuYWJsZXMgcmV3cml0dGVuIHZlcnNpb24gb2YgUmVhY3RGaWJlclNjaGVkdWxlci4gQWRkZWQgaW4gY2FzZSB3ZSBuZWVkIHRvXG4vLyBxdWlja2x5IHJldmVydCBpdC5cblxuXG4vLyBOZXcgQVBJIGZvciBKU1ggdHJhbnNmb3JtcyB0byB0YXJnZXQgLSBodHRwczovL2dpdGh1Yi5jb20vcmVhY3Rqcy9yZmNzL3B1bGwvMTA3XG5cbnZhciBERUZBVUxUX1RIUkVBRF9JRCA9IDA7XG5cbi8vIENvdW50ZXJzIHVzZWQgdG8gZ2VuZXJhdGUgdW5pcXVlIElEcy5cbnZhciBpbnRlcmFjdGlvbklEQ291bnRlciA9IDA7XG52YXIgdGhyZWFkSURDb3VudGVyID0gMDtcblxuLy8gU2V0IG9mIGN1cnJlbnRseSB0cmFjZWQgaW50ZXJhY3Rpb25zLlxuLy8gSW50ZXJhY3Rpb25zIFwic3RhY2tcIuKAk1xuLy8gTWVhbmluZyB0aGF0IG5ld2x5IHRyYWNlZCBpbnRlcmFjdGlvbnMgYXJlIGFwcGVuZGVkIHRvIHRoZSBwcmV2aW91c2x5IGFjdGl2ZSBzZXQuXG4vLyBXaGVuIGFuIGludGVyYWN0aW9uIGdvZXMgb3V0IG9mIHNjb3BlLCB0aGUgcHJldmlvdXMgc2V0IChpZiBhbnkpIGlzIHJlc3RvcmVkLlxuZXhwb3J0cy5fX2ludGVyYWN0aW9uc1JlZiA9IG51bGw7XG5cbi8vIExpc3RlbmVyKHMpIHRvIG5vdGlmeSB3aGVuIGludGVyYWN0aW9ucyBiZWdpbiBhbmQgZW5kLlxuZXhwb3J0cy5fX3N1YnNjcmliZXJSZWYgPSBudWxsO1xuXG5pZiAoZW5hYmxlU2NoZWR1bGVyVHJhY2luZykge1xuICBleHBvcnRzLl9faW50ZXJhY3Rpb25zUmVmID0ge1xuICAgIGN1cnJlbnQ6IG5ldyBTZXQoKVxuICB9O1xuICBleHBvcnRzLl9fc3Vic2NyaWJlclJlZiA9IHtcbiAgICBjdXJyZW50OiBudWxsXG4gIH07XG59XG5cbmZ1bmN0aW9uIHVuc3RhYmxlX2NsZWFyKGNhbGxiYWNrKSB7XG4gIGlmICghZW5hYmxlU2NoZWR1bGVyVHJhY2luZykge1xuICAgIHJldHVybiBjYWxsYmFjaygpO1xuICB9XG5cbiAgdmFyIHByZXZJbnRlcmFjdGlvbnMgPSBleHBvcnRzLl9faW50ZXJhY3Rpb25zUmVmLmN1cnJlbnQ7XG4gIGV4cG9ydHMuX19pbnRlcmFjdGlvbnNSZWYuY3VycmVudCA9IG5ldyBTZXQoKTtcblxuICB0cnkge1xuICAgIHJldHVybiBjYWxsYmFjaygpO1xuICB9IGZpbmFsbHkge1xuICAgIGV4cG9ydHMuX19pbnRlcmFjdGlvbnNSZWYuY3VycmVudCA9IHByZXZJbnRlcmFjdGlvbnM7XG4gIH1cbn1cblxuZnVuY3Rpb24gdW5zdGFibGVfZ2V0Q3VycmVudCgpIHtcbiAgaWYgKCFlbmFibGVTY2hlZHVsZXJUcmFjaW5nKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGV4cG9ydHMuX19pbnRlcmFjdGlvbnNSZWYuY3VycmVudDtcbiAgfVxufVxuXG5mdW5jdGlvbiB1bnN0YWJsZV9nZXRUaHJlYWRJRCgpIHtcbiAgcmV0dXJuICsrdGhyZWFkSURDb3VudGVyO1xufVxuXG5mdW5jdGlvbiB1bnN0YWJsZV90cmFjZShuYW1lLCB0aW1lc3RhbXAsIGNhbGxiYWNrKSB7XG4gIHZhciB0aHJlYWRJRCA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogREVGQVVMVF9USFJFQURfSUQ7XG5cbiAgaWYgKCFlbmFibGVTY2hlZHVsZXJUcmFjaW5nKSB7XG4gICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gIH1cblxuICB2YXIgaW50ZXJhY3Rpb24gPSB7XG4gICAgX19jb3VudDogMSxcbiAgICBpZDogaW50ZXJhY3Rpb25JRENvdW50ZXIrKyxcbiAgICBuYW1lOiBuYW1lLFxuICAgIHRpbWVzdGFtcDogdGltZXN0YW1wXG4gIH07XG5cbiAgdmFyIHByZXZJbnRlcmFjdGlvbnMgPSBleHBvcnRzLl9faW50ZXJhY3Rpb25zUmVmLmN1cnJlbnQ7XG5cbiAgLy8gVHJhY2VkIGludGVyYWN0aW9ucyBzaG91bGQgc3RhY2svYWNjdW11bGF0ZS5cbiAgLy8gVG8gZG8gdGhhdCwgY2xvbmUgdGhlIGN1cnJlbnQgaW50ZXJhY3Rpb25zLlxuICAvLyBUaGUgcHJldmlvdXMgc2V0IHdpbGwgYmUgcmVzdG9yZWQgdXBvbiBjb21wbGV0aW9uLlxuICB2YXIgaW50ZXJhY3Rpb25zID0gbmV3IFNldChwcmV2SW50ZXJhY3Rpb25zKTtcbiAgaW50ZXJhY3Rpb25zLmFkZChpbnRlcmFjdGlvbik7XG4gIGV4cG9ydHMuX19pbnRlcmFjdGlvbnNSZWYuY3VycmVudCA9IGludGVyYWN0aW9ucztcblxuICB2YXIgc3Vic2NyaWJlciA9IGV4cG9ydHMuX19zdWJzY3JpYmVyUmVmLmN1cnJlbnQ7XG4gIHZhciByZXR1cm5WYWx1ZSA9IHZvaWQgMDtcblxuICB0cnkge1xuICAgIGlmIChzdWJzY3JpYmVyICE9PSBudWxsKSB7XG4gICAgICBzdWJzY3JpYmVyLm9uSW50ZXJhY3Rpb25UcmFjZWQoaW50ZXJhY3Rpb24pO1xuICAgIH1cbiAgfSBmaW5hbGx5IHtcbiAgICB0cnkge1xuICAgICAgaWYgKHN1YnNjcmliZXIgIT09IG51bGwpIHtcbiAgICAgICAgc3Vic2NyaWJlci5vbldvcmtTdGFydGVkKGludGVyYWN0aW9ucywgdGhyZWFkSUQpO1xuICAgICAgfVxuICAgIH0gZmluYWxseSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm5WYWx1ZSA9IGNhbGxiYWNrKCk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBleHBvcnRzLl9faW50ZXJhY3Rpb25zUmVmLmN1cnJlbnQgPSBwcmV2SW50ZXJhY3Rpb25zO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKHN1YnNjcmliZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIub25Xb3JrU3RvcHBlZChpbnRlcmFjdGlvbnMsIHRocmVhZElEKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgaW50ZXJhY3Rpb24uX19jb3VudC0tO1xuXG4gICAgICAgICAgLy8gSWYgbm8gYXN5bmMgd29yayB3YXMgc2NoZWR1bGVkIGZvciB0aGlzIGludGVyYWN0aW9uLFxuICAgICAgICAgIC8vIE5vdGlmeSBzdWJzY3JpYmVycyB0aGF0IGl0J3MgY29tcGxldGVkLlxuICAgICAgICAgIGlmIChzdWJzY3JpYmVyICE9PSBudWxsICYmIGludGVyYWN0aW9uLl9fY291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIub25JbnRlcmFjdGlvblNjaGVkdWxlZFdvcmtDb21wbGV0ZWQoaW50ZXJhY3Rpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXR1cm5WYWx1ZTtcbn1cblxuZnVuY3Rpb24gdW5zdGFibGVfd3JhcChjYWxsYmFjaykge1xuICB2YXIgdGhyZWFkSUQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IERFRkFVTFRfVEhSRUFEX0lEO1xuXG4gIGlmICghZW5hYmxlU2NoZWR1bGVyVHJhY2luZykge1xuICAgIHJldHVybiBjYWxsYmFjaztcbiAgfVxuXG4gIHZhciB3cmFwcGVkSW50ZXJhY3Rpb25zID0gZXhwb3J0cy5fX2ludGVyYWN0aW9uc1JlZi5jdXJyZW50O1xuXG4gIHZhciBzdWJzY3JpYmVyID0gZXhwb3J0cy5fX3N1YnNjcmliZXJSZWYuY3VycmVudDtcbiAgaWYgKHN1YnNjcmliZXIgIT09IG51bGwpIHtcbiAgICBzdWJzY3JpYmVyLm9uV29ya1NjaGVkdWxlZCh3cmFwcGVkSW50ZXJhY3Rpb25zLCB0aHJlYWRJRCk7XG4gIH1cblxuICAvLyBVcGRhdGUgdGhlIHBlbmRpbmcgYXN5bmMgd29yayBjb3VudCBmb3IgdGhlIGN1cnJlbnQgaW50ZXJhY3Rpb25zLlxuICAvLyBVcGRhdGUgYWZ0ZXIgY2FsbGluZyBzdWJzY3JpYmVycyBpbiBjYXNlIG9mIGVycm9yLlxuICB3cmFwcGVkSW50ZXJhY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKGludGVyYWN0aW9uKSB7XG4gICAgaW50ZXJhY3Rpb24uX19jb3VudCsrO1xuICB9KTtcblxuICB2YXIgaGFzUnVuID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gd3JhcHBlZCgpIHtcbiAgICB2YXIgcHJldkludGVyYWN0aW9ucyA9IGV4cG9ydHMuX19pbnRlcmFjdGlvbnNSZWYuY3VycmVudDtcbiAgICBleHBvcnRzLl9faW50ZXJhY3Rpb25zUmVmLmN1cnJlbnQgPSB3cmFwcGVkSW50ZXJhY3Rpb25zO1xuXG4gICAgc3Vic2NyaWJlciA9IGV4cG9ydHMuX19zdWJzY3JpYmVyUmVmLmN1cnJlbnQ7XG5cbiAgICB0cnkge1xuICAgICAgdmFyIHJldHVyblZhbHVlID0gdm9pZCAwO1xuXG4gICAgICB0cnkge1xuICAgICAgICBpZiAoc3Vic2NyaWJlciAhPT0gbnVsbCkge1xuICAgICAgICAgIHN1YnNjcmliZXIub25Xb3JrU3RhcnRlZCh3cmFwcGVkSW50ZXJhY3Rpb25zLCB0aHJlYWRJRCk7XG4gICAgICAgIH1cbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuVmFsdWUgPSBjYWxsYmFjay5hcHBseSh1bmRlZmluZWQsIGFyZ3VtZW50cyk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgZXhwb3J0cy5fX2ludGVyYWN0aW9uc1JlZi5jdXJyZW50ID0gcHJldkludGVyYWN0aW9ucztcblxuICAgICAgICAgIGlmIChzdWJzY3JpYmVyICE9PSBudWxsKSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyLm9uV29ya1N0b3BwZWQod3JhcHBlZEludGVyYWN0aW9ucywgdGhyZWFkSUQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGlmICghaGFzUnVuKSB7XG4gICAgICAgIC8vIFdlIG9ubHkgZXhwZWN0IGEgd3JhcHBlZCBmdW5jdGlvbiB0byBiZSBleGVjdXRlZCBvbmNlLFxuICAgICAgICAvLyBCdXQgaW4gdGhlIGV2ZW50IHRoYXQgaXQncyBleGVjdXRlZCBtb3JlIHRoYW4gb25jZeKAk1xuICAgICAgICAvLyBPbmx5IGRlY3JlbWVudCB0aGUgb3V0c3RhbmRpbmcgaW50ZXJhY3Rpb24gY291bnRzIG9uY2UuXG4gICAgICAgIGhhc1J1biA9IHRydWU7XG5cbiAgICAgICAgLy8gVXBkYXRlIHBlbmRpbmcgYXN5bmMgY291bnRzIGZvciBhbGwgd3JhcHBlZCBpbnRlcmFjdGlvbnMuXG4gICAgICAgIC8vIElmIHRoaXMgd2FzIHRoZSBsYXN0IHNjaGVkdWxlZCBhc3luYyB3b3JrIGZvciBhbnkgb2YgdGhlbSxcbiAgICAgICAgLy8gTWFyayB0aGVtIGFzIGNvbXBsZXRlZC5cbiAgICAgICAgd3JhcHBlZEludGVyYWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChpbnRlcmFjdGlvbikge1xuICAgICAgICAgIGludGVyYWN0aW9uLl9fY291bnQtLTtcblxuICAgICAgICAgIGlmIChzdWJzY3JpYmVyICE9PSBudWxsICYmIGludGVyYWN0aW9uLl9fY291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIub25JbnRlcmFjdGlvblNjaGVkdWxlZFdvcmtDb21wbGV0ZWQoaW50ZXJhY3Rpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgd3JhcHBlZC5jYW5jZWwgPSBmdW5jdGlvbiBjYW5jZWwoKSB7XG4gICAgc3Vic2NyaWJlciA9IGV4cG9ydHMuX19zdWJzY3JpYmVyUmVmLmN1cnJlbnQ7XG5cbiAgICB0cnkge1xuICAgICAgaWYgKHN1YnNjcmliZXIgIT09IG51bGwpIHtcbiAgICAgICAgc3Vic2NyaWJlci5vbldvcmtDYW5jZWxlZCh3cmFwcGVkSW50ZXJhY3Rpb25zLCB0aHJlYWRJRCk7XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIFVwZGF0ZSBwZW5kaW5nIGFzeW5jIGNvdW50cyBmb3IgYWxsIHdyYXBwZWQgaW50ZXJhY3Rpb25zLlxuICAgICAgLy8gSWYgdGhpcyB3YXMgdGhlIGxhc3Qgc2NoZWR1bGVkIGFzeW5jIHdvcmsgZm9yIGFueSBvZiB0aGVtLFxuICAgICAgLy8gTWFyayB0aGVtIGFzIGNvbXBsZXRlZC5cbiAgICAgIHdyYXBwZWRJbnRlcmFjdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoaW50ZXJhY3Rpb24pIHtcbiAgICAgICAgaW50ZXJhY3Rpb24uX19jb3VudC0tO1xuXG4gICAgICAgIGlmIChzdWJzY3JpYmVyICYmIGludGVyYWN0aW9uLl9fY291bnQgPT09IDApIHtcbiAgICAgICAgICBzdWJzY3JpYmVyLm9uSW50ZXJhY3Rpb25TY2hlZHVsZWRXb3JrQ29tcGxldGVkKGludGVyYWN0aW9uKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB3cmFwcGVkO1xufVxuXG52YXIgc3Vic2NyaWJlcnMgPSBudWxsO1xuaWYgKGVuYWJsZVNjaGVkdWxlclRyYWNpbmcpIHtcbiAgc3Vic2NyaWJlcnMgPSBuZXcgU2V0KCk7XG59XG5cbmZ1bmN0aW9uIHVuc3RhYmxlX3N1YnNjcmliZShzdWJzY3JpYmVyKSB7XG4gIGlmIChlbmFibGVTY2hlZHVsZXJUcmFjaW5nKSB7XG4gICAgc3Vic2NyaWJlcnMuYWRkKHN1YnNjcmliZXIpO1xuXG4gICAgaWYgKHN1YnNjcmliZXJzLnNpemUgPT09IDEpIHtcbiAgICAgIGV4cG9ydHMuX19zdWJzY3JpYmVyUmVmLmN1cnJlbnQgPSB7XG4gICAgICAgIG9uSW50ZXJhY3Rpb25TY2hlZHVsZWRXb3JrQ29tcGxldGVkOiBvbkludGVyYWN0aW9uU2NoZWR1bGVkV29ya0NvbXBsZXRlZCxcbiAgICAgICAgb25JbnRlcmFjdGlvblRyYWNlZDogb25JbnRlcmFjdGlvblRyYWNlZCxcbiAgICAgICAgb25Xb3JrQ2FuY2VsZWQ6IG9uV29ya0NhbmNlbGVkLFxuICAgICAgICBvbldvcmtTY2hlZHVsZWQ6IG9uV29ya1NjaGVkdWxlZCxcbiAgICAgICAgb25Xb3JrU3RhcnRlZDogb25Xb3JrU3RhcnRlZCxcbiAgICAgICAgb25Xb3JrU3RvcHBlZDogb25Xb3JrU3RvcHBlZFxuICAgICAgfTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gdW5zdGFibGVfdW5zdWJzY3JpYmUoc3Vic2NyaWJlcikge1xuICBpZiAoZW5hYmxlU2NoZWR1bGVyVHJhY2luZykge1xuICAgIHN1YnNjcmliZXJzLmRlbGV0ZShzdWJzY3JpYmVyKTtcblxuICAgIGlmIChzdWJzY3JpYmVycy5zaXplID09PSAwKSB7XG4gICAgICBleHBvcnRzLl9fc3Vic2NyaWJlclJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gb25JbnRlcmFjdGlvblRyYWNlZChpbnRlcmFjdGlvbikge1xuICB2YXIgZGlkQ2F0Y2hFcnJvciA9IGZhbHNlO1xuICB2YXIgY2F1Z2h0RXJyb3IgPSBudWxsO1xuXG4gIHN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICB0cnkge1xuICAgICAgc3Vic2NyaWJlci5vbkludGVyYWN0aW9uVHJhY2VkKGludGVyYWN0aW9uKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKCFkaWRDYXRjaEVycm9yKSB7XG4gICAgICAgIGRpZENhdGNoRXJyb3IgPSB0cnVlO1xuICAgICAgICBjYXVnaHRFcnJvciA9IGVycm9yO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgaWYgKGRpZENhdGNoRXJyb3IpIHtcbiAgICB0aHJvdyBjYXVnaHRFcnJvcjtcbiAgfVxufVxuXG5mdW5jdGlvbiBvbkludGVyYWN0aW9uU2NoZWR1bGVkV29ya0NvbXBsZXRlZChpbnRlcmFjdGlvbikge1xuICB2YXIgZGlkQ2F0Y2hFcnJvciA9IGZhbHNlO1xuICB2YXIgY2F1Z2h0RXJyb3IgPSBudWxsO1xuXG4gIHN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICB0cnkge1xuICAgICAgc3Vic2NyaWJlci5vbkludGVyYWN0aW9uU2NoZWR1bGVkV29ya0NvbXBsZXRlZChpbnRlcmFjdGlvbik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmICghZGlkQ2F0Y2hFcnJvcikge1xuICAgICAgICBkaWRDYXRjaEVycm9yID0gdHJ1ZTtcbiAgICAgICAgY2F1Z2h0RXJyb3IgPSBlcnJvcjtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIGlmIChkaWRDYXRjaEVycm9yKSB7XG4gICAgdGhyb3cgY2F1Z2h0RXJyb3I7XG4gIH1cbn1cblxuZnVuY3Rpb24gb25Xb3JrU2NoZWR1bGVkKGludGVyYWN0aW9ucywgdGhyZWFkSUQpIHtcbiAgdmFyIGRpZENhdGNoRXJyb3IgPSBmYWxzZTtcbiAgdmFyIGNhdWdodEVycm9yID0gbnVsbDtcblxuICBzdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgdHJ5IHtcbiAgICAgIHN1YnNjcmliZXIub25Xb3JrU2NoZWR1bGVkKGludGVyYWN0aW9ucywgdGhyZWFkSUQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoIWRpZENhdGNoRXJyb3IpIHtcbiAgICAgICAgZGlkQ2F0Y2hFcnJvciA9IHRydWU7XG4gICAgICAgIGNhdWdodEVycm9yID0gZXJyb3I7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBpZiAoZGlkQ2F0Y2hFcnJvcikge1xuICAgIHRocm93IGNhdWdodEVycm9yO1xuICB9XG59XG5cbmZ1bmN0aW9uIG9uV29ya1N0YXJ0ZWQoaW50ZXJhY3Rpb25zLCB0aHJlYWRJRCkge1xuICB2YXIgZGlkQ2F0Y2hFcnJvciA9IGZhbHNlO1xuICB2YXIgY2F1Z2h0RXJyb3IgPSBudWxsO1xuXG4gIHN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICB0cnkge1xuICAgICAgc3Vic2NyaWJlci5vbldvcmtTdGFydGVkKGludGVyYWN0aW9ucywgdGhyZWFkSUQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoIWRpZENhdGNoRXJyb3IpIHtcbiAgICAgICAgZGlkQ2F0Y2hFcnJvciA9IHRydWU7XG4gICAgICAgIGNhdWdodEVycm9yID0gZXJyb3I7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBpZiAoZGlkQ2F0Y2hFcnJvcikge1xuICAgIHRocm93IGNhdWdodEVycm9yO1xuICB9XG59XG5cbmZ1bmN0aW9uIG9uV29ya1N0b3BwZWQoaW50ZXJhY3Rpb25zLCB0aHJlYWRJRCkge1xuICB2YXIgZGlkQ2F0Y2hFcnJvciA9IGZhbHNlO1xuICB2YXIgY2F1Z2h0RXJyb3IgPSBudWxsO1xuXG4gIHN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICB0cnkge1xuICAgICAgc3Vic2NyaWJlci5vbldvcmtTdG9wcGVkKGludGVyYWN0aW9ucywgdGhyZWFkSUQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoIWRpZENhdGNoRXJyb3IpIHtcbiAgICAgICAgZGlkQ2F0Y2hFcnJvciA9IHRydWU7XG4gICAgICAgIGNhdWdodEVycm9yID0gZXJyb3I7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBpZiAoZGlkQ2F0Y2hFcnJvcikge1xuICAgIHRocm93IGNhdWdodEVycm9yO1xuICB9XG59XG5cbmZ1bmN0aW9uIG9uV29ya0NhbmNlbGVkKGludGVyYWN0aW9ucywgdGhyZWFkSUQpIHtcbiAgdmFyIGRpZENhdGNoRXJyb3IgPSBmYWxzZTtcbiAgdmFyIGNhdWdodEVycm9yID0gbnVsbDtcblxuICBzdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgdHJ5IHtcbiAgICAgIHN1YnNjcmliZXIub25Xb3JrQ2FuY2VsZWQoaW50ZXJhY3Rpb25zLCB0aHJlYWRJRCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmICghZGlkQ2F0Y2hFcnJvcikge1xuICAgICAgICBkaWRDYXRjaEVycm9yID0gdHJ1ZTtcbiAgICAgICAgY2F1Z2h0RXJyb3IgPSBlcnJvcjtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIGlmIChkaWRDYXRjaEVycm9yKSB7XG4gICAgdGhyb3cgY2F1Z2h0RXJyb3I7XG4gIH1cbn1cblxuZXhwb3J0cy51bnN0YWJsZV9jbGVhciA9IHVuc3RhYmxlX2NsZWFyO1xuZXhwb3J0cy51bnN0YWJsZV9nZXRDdXJyZW50ID0gdW5zdGFibGVfZ2V0Q3VycmVudDtcbmV4cG9ydHMudW5zdGFibGVfZ2V0VGhyZWFkSUQgPSB1bnN0YWJsZV9nZXRUaHJlYWRJRDtcbmV4cG9ydHMudW5zdGFibGVfdHJhY2UgPSB1bnN0YWJsZV90cmFjZTtcbmV4cG9ydHMudW5zdGFibGVfd3JhcCA9IHVuc3RhYmxlX3dyYXA7XG5leHBvcnRzLnVuc3RhYmxlX3N1YnNjcmliZSA9IHVuc3RhYmxlX3N1YnNjcmliZTtcbmV4cG9ydHMudW5zdGFibGVfdW5zdWJzY3JpYmUgPSB1bnN0YWJsZV91bnN1YnNjcmliZTtcbiAgfSkoKTtcbn1cbiJdfQ==