{"version":3,"sources":["selectorFactory.js"],"names":["_interopRequireDefault","require","exports","__esModule","impureFinalPropsSelectorFactory","pureFinalPropsSelectorFactory","finalPropsSelectorFactory","_objectWithoutPropertiesLoose2","_verifySubselectors","mapStateToProps","mapDispatchToProps","mergeProps","dispatch","impureFinalPropsSelector","state","ownProps","_ref","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","hasRunAtLeastOnce","stateProps","dispatchProps","mergedProps","handleFirstCall","firstState","firstOwnProps","handleNewPropsAndNewState","dependsOnOwnProps","handleNewProps","handleNewState","nextStateProps","statePropsChanged","handleSubsequentCalls","nextState","nextOwnProps","propsChanged","stateChanged","pureFinalPropsSelector","_ref2","initMapStateToProps","initMapDispatchToProps","initMergeProps","options","process","env","NODE_ENV","displayName","selectorFactory","pure"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.impureFinalPropsSelectorFactory = impureFinalPropsSelectorFactory;\nexports.pureFinalPropsSelectorFactory = pureFinalPropsSelectorFactory;\nexports[\"default\"] = finalPropsSelectorFactory;\n\nvar _objectWithoutPropertiesLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutPropertiesLoose\"));\n\nvar _verifySubselectors = _interopRequireDefault(require(\"./verifySubselectors\"));\n\nfunction impureFinalPropsSelectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch) {\n  return function impureFinalPropsSelector(state, ownProps) {\n    return mergeProps(mapStateToProps(state, ownProps), mapDispatchToProps(dispatch, ownProps), ownProps);\n  };\n}\n\nfunction pureFinalPropsSelectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch, _ref) {\n  var areStatesEqual = _ref.areStatesEqual,\n      areOwnPropsEqual = _ref.areOwnPropsEqual,\n      areStatePropsEqual = _ref.areStatePropsEqual;\n  var hasRunAtLeastOnce = false;\n  var state;\n  var ownProps;\n  var stateProps;\n  var dispatchProps;\n  var mergedProps;\n\n  function handleFirstCall(firstState, firstOwnProps) {\n    state = firstState;\n    ownProps = firstOwnProps;\n    stateProps = mapStateToProps(state, ownProps);\n    dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    hasRunAtLeastOnce = true;\n    return mergedProps;\n  }\n\n  function handleNewPropsAndNewState() {\n    stateProps = mapStateToProps(state, ownProps);\n    if (mapDispatchToProps.dependsOnOwnProps) dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleNewProps() {\n    if (mapStateToProps.dependsOnOwnProps) stateProps = mapStateToProps(state, ownProps);\n    if (mapDispatchToProps.dependsOnOwnProps) dispatchProps = mapDispatchToProps(dispatch, ownProps);\n    mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleNewState() {\n    var nextStateProps = mapStateToProps(state, ownProps);\n    var statePropsChanged = !areStatePropsEqual(nextStateProps, stateProps);\n    stateProps = nextStateProps;\n    if (statePropsChanged) mergedProps = mergeProps(stateProps, dispatchProps, ownProps);\n    return mergedProps;\n  }\n\n  function handleSubsequentCalls(nextState, nextOwnProps) {\n    var propsChanged = !areOwnPropsEqual(nextOwnProps, ownProps);\n    var stateChanged = !areStatesEqual(nextState, state);\n    state = nextState;\n    ownProps = nextOwnProps;\n    if (propsChanged && stateChanged) return handleNewPropsAndNewState();\n    if (propsChanged) return handleNewProps();\n    if (stateChanged) return handleNewState();\n    return mergedProps;\n  }\n\n  return function pureFinalPropsSelector(nextState, nextOwnProps) {\n    return hasRunAtLeastOnce ? handleSubsequentCalls(nextState, nextOwnProps) : handleFirstCall(nextState, nextOwnProps);\n  };\n} // TODO: Add more comments\n// If pure is true, the selector returned by selectorFactory will memoize its results,\n// allowing connectAdvanced's shouldComponentUpdate to return false if final\n// props have not changed. If false, the selector will always return a new\n// object and shouldComponentUpdate will always return true.\n\n\nfunction finalPropsSelectorFactory(dispatch, _ref2) {\n  var initMapStateToProps = _ref2.initMapStateToProps,\n      initMapDispatchToProps = _ref2.initMapDispatchToProps,\n      initMergeProps = _ref2.initMergeProps,\n      options = (0, _objectWithoutPropertiesLoose2[\"default\"])(_ref2, [\"initMapStateToProps\", \"initMapDispatchToProps\", \"initMergeProps\"]);\n  var mapStateToProps = initMapStateToProps(dispatch, options);\n  var mapDispatchToProps = initMapDispatchToProps(dispatch, options);\n  var mergeProps = initMergeProps(dispatch, options);\n\n  if (process.env.NODE_ENV !== 'production') {\n    (0, _verifySubselectors[\"default\"])(mapStateToProps, mapDispatchToProps, mergeProps, options.displayName);\n  }\n\n  var selectorFactory = options.pure ? pureFinalPropsSelectorFactory : impureFinalPropsSelectorFactory;\n  return selectorFactory(mapStateToProps, mapDispatchToProps, mergeProps, dispatch, options);\n}"]}