2568e08401ed35ed8339642ccc7b45c8
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));

var React = require('react');

var Text = require('../../Text/Text');

var UTFSequence = require('../../UTFSequence');

var stringifySafe = require('../../Utilities/stringifySafe');

var SUBSTITUTION = UTFSequence.BOM + '%s';
var YellowBoxCategory = {
  parse: function parse(args) {
    var categoryParts = [];
    var contentParts = [];
    var substitutionOffsets = [];
    var remaining = (0, _toConsumableArray2.default)(args);

    if (typeof remaining[0] === 'string') {
      var formatString = String(remaining.shift());
      var formatStringParts = formatString.split('%s');
      var substitutionCount = formatStringParts.length - 1;
      var substitutions = remaining.splice(0, substitutionCount);
      var categoryString = '';
      var contentString = '';
      var substitutionIndex = 0;

      for (var _iterator = formatStringParts, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[typeof Symbol === "function" ? Symbol.iterator : "@@iterator"]();;) {
        var _ref;

        if (_isArray) {
          if (_i >= _iterator.length) break;
          _ref = _iterator[_i++];
        } else {
          _i = _iterator.next();
          if (_i.done) break;
          _ref = _i.value;
        }

        var _formatStringPart = _ref;
        categoryString += _formatStringPart;
        contentString += _formatStringPart;

        if (substitutionIndex < substitutionCount) {
          if (substitutionIndex < substitutions.length) {
            var substitution = stringifySafe(substitutions[substitutionIndex]);
            substitutionOffsets.push({
              length: substitution.length,
              offset: contentString.length
            });
            categoryString += SUBSTITUTION;
            contentString += substitution;
          } else {
            substitutionOffsets.push({
              length: 2,
              offset: contentString.length
            });
            categoryString += '%s';
            contentString += '%s';
          }

          substitutionIndex++;
        }
      }

      categoryParts.push(categoryString);
      contentParts.push(contentString);
    }

    var remainingArgs = remaining.map(stringifySafe);
    categoryParts.push.apply(categoryParts, (0, _toConsumableArray2.default)(remainingArgs));
    contentParts.push.apply(contentParts, (0, _toConsumableArray2.default)(remainingArgs));
    return {
      category: categoryParts.join(' '),
      message: {
        content: contentParts.join(' '),
        substitutions: substitutionOffsets
      }
    };
  },
  render: function render(_ref2, substitutionStyle) {
    var content = _ref2.content,
        substitutions = _ref2.substitutions;
    var elements = [];
    var lastOffset = substitutions.reduce(function (prevOffset, substitution, index) {
      var key = String(index);

      if (substitution.offset > prevOffset) {
        var prevPart = content.substr(prevOffset, substitution.offset - prevOffset);
        elements.push(React.createElement(Text, {
          key: key
        }, prevPart));
      }

      var substititionPart = content.substr(substitution.offset, substitution.length);
      elements.push(React.createElement(Text, {
        key: key + '.5',
        style: substitutionStyle
      }, substititionPart));
      return substitution.offset + substitution.length;
    }, 0);

    if (lastOffset < content.length) {
      var lastPart = content.substr(lastOffset);
      elements.push(React.createElement(Text, {
        key: "-1"
      }, lastPart));
    }

    return elements;
  }
};
module.exports = YellowBoxCategory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlllbGxvd0JveENhdGVnb3J5LmpzIl0sIm5hbWVzIjpbIlJlYWN0IiwicmVxdWlyZSIsIlRleHQiLCJVVEZTZXF1ZW5jZSIsInN0cmluZ2lmeVNhZmUiLCJTVUJTVElUVVRJT04iLCJCT00iLCJZZWxsb3dCb3hDYXRlZ29yeSIsInBhcnNlIiwiYXJncyIsImNhdGVnb3J5UGFydHMiLCJjb250ZW50UGFydHMiLCJzdWJzdGl0dXRpb25PZmZzZXRzIiwicmVtYWluaW5nIiwiZm9ybWF0U3RyaW5nIiwiU3RyaW5nIiwic2hpZnQiLCJmb3JtYXRTdHJpbmdQYXJ0cyIsInNwbGl0Iiwic3Vic3RpdHV0aW9uQ291bnQiLCJsZW5ndGgiLCJzdWJzdGl0dXRpb25zIiwic3BsaWNlIiwiY2F0ZWdvcnlTdHJpbmciLCJjb250ZW50U3RyaW5nIiwic3Vic3RpdHV0aW9uSW5kZXgiLCJmb3JtYXRTdHJpbmdQYXJ0Iiwic3Vic3RpdHV0aW9uIiwicHVzaCIsIm9mZnNldCIsInJlbWFpbmluZ0FyZ3MiLCJtYXAiLCJjYXRlZ29yeSIsImpvaW4iLCJtZXNzYWdlIiwiY29udGVudCIsInJlbmRlciIsInN1YnN0aXR1dGlvblN0eWxlIiwiZWxlbWVudHMiLCJsYXN0T2Zmc2V0IiwicmVkdWNlIiwicHJldk9mZnNldCIsImluZGV4Iiwia2V5IiwicHJldlBhcnQiLCJzdWJzdHIiLCJzdWJzdGl0aXRpb25QYXJ0IiwibGFzdFBhcnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFVQTs7Ozs7O0FBRUEsSUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFyQjs7QUFDQSxJQUFNQyxJQUFJLEdBQUdELE9BQU8sQ0FBQyxpQkFBRCxDQUFwQjs7QUFDQSxJQUFNRSxXQUFXLEdBQUdGLE9BQU8sQ0FBQyxtQkFBRCxDQUEzQjs7QUFFQSxJQUFNRyxhQUFhLEdBQUdILE9BQU8sQ0FBQywrQkFBRCxDQUE3Qjs7QUFlQSxJQUFNSSxZQUFZLEdBQUdGLFdBQVcsQ0FB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QUQ7QUFBTSxRQUFBLEdBQUcsRUFBQztBQUFWLFNBQWdCbUIsUUFBaEIsQ0FBZDtBQUNEOztBQUVELFdBQU9ULFFBQVA7QUFDRDtBQTdHdUIsQ0FBMUI7QUFnSEFVLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjFDLGlCQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBGYWNlYm9vaywgSW5jLiBhbmQgaXRzIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3cgc3RyaWN0LWxvY2FsXG4gKiBAZm9ybWF0XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XG5jb25zdCBUZXh0ID0gcmVxdWlyZSgnLi4vLi4vVGV4dC9UZXh0Jyk7XG5jb25zdCBVVEZTZXF1ZW5jZSA9IHJlcXVpcmUoJy4uLy4uL1VURlNlcXVlbmNlJyk7XG5cbmNvbnN0IHN0cmluZ2lmeVNhZmUgPSByZXF1aXJlKCcuLi8uLi9VdGlsaXRpZXMvc3RyaW5naWZ5U2FmZScpO1xuXG5pbXBvcnQgdHlwZSB7VGV4dFN0eWxlUHJvcH0gZnJvbSAnLi4vLi4vU3R5bGVTaGVldC9TdHlsZVNoZWV0JztcblxuZXhwb3J0IHR5cGUgQ2F0ZWdvcnkgPSBzdHJpbmc7XG5leHBvcnQgdHlwZSBNZXNzYWdlID0gJFJlYWRPbmx5PHt8XG4gIGNvbnRlbnQ6IHN0cmluZyxcbiAgc3Vic3RpdHV0aW9uczogJFJlYWRPbmx5QXJyYXk8XG4gICAgJFJlYWRPbmx5PHt8XG4gICAgICBsZW5ndGg6IG51bWJlcixcbiAgICAgIG9mZnNldDogbnVtYmVyLFxuICAgIHx9PixcbiAgPixcbnx9PjtcblxuY29uc3QgU1VCU1RJVFVUSU9OID0gVVRGU2VxdWVuY2UuQk9NICsgJyVzJztcblxuY29uc3QgWWVsbG93Qm94Q2F0ZWdvcnkgPSB7XG4gIHBhcnNlKFxuICAgIGFyZ3M6ICRSZWFkT25seUFycmF5PG1peGVkPixcbiAgKTogJFJlYWRPbmx5PHt8XG4gICAgY2F0ZWdvcnk6IENhdGVnb3J5LFxuICAgIG1lc3NhZ2U6IE1lc3NhZ2UsXG4gIHx9PiB7XG4gICAgY29uc3QgY2F0ZWdvcnlQYXJ0cyA9IFtdO1xuICAgIGNvbnN0IGNvbnRlbnRQYXJ0cyA9IFtdO1xuICAgIGNvbnN0IHN1YnN0aXR1dGlvbk9mZnNldHMgPSBbXTtcblxuICAgIGNvbnN0IHJlbWFpbmluZyA9IFsuLi5hcmdzXTtcblxuICAgIGlmICh0eXBlb2YgcmVtYWluaW5nWzBdID09PSAnc3RyaW5nJykge1xuICAgICAgY29uc3QgZm9ybWF0U3RyaW5nID0gU3RyaW5nKHJlbWFpbmluZy5zaGlmdCgpKTtcbiAgICAgIGNvbnN0IGZvcm1hdFN0cmluZ1BhcnRzID0gZm9ybWF0U3RyaW5nLnNwbGl0KCclcycpO1xuICAgICAgY29uc3Qgc3Vic3RpdHV0aW9uQ291bnQgPSBmb3JtYXRTdHJpbmdQYXJ0cy5sZW5ndGggLSAxO1xuICAgICAgY29uc3Qgc3Vic3RpdHV0aW9ucyA9IHJlbWFpbmluZy5zcGxpY2UoMCwgc3Vic3RpdHV0aW9uQ291bnQpO1xuXG4gICAgICBsZXQgY2F0ZWdvcnlTdHJpbmcgPSAnJztcbiAgICAgIGxldCBjb250ZW50U3RyaW5nID0gJyc7XG5cbiAgICAgIGxldCBzdWJzdGl0dXRpb25JbmRleCA9IDA7XG4gICAgICBmb3IgKGNvbnN0IGZvcm1hdFN0cmluZ1BhcnQgb2YgZm9ybWF0U3RyaW5nUGFydHMpIHtcbiAgICAgICAgY2F0ZWdvcnlTdHJpbmcgKz0gZm9ybWF0U3RyaW5nUGFydDtcbiAgICAgICAgY29udGVudFN0cmluZyArPSBmb3JtYXRTdHJpbmdQYXJ0O1xuXG4gICAgICAgIGlmIChzdWJzdGl0dXRpb25JbmRleCA8IHN1YnN0aXR1dGlvbkNvdW50KSB7XG4gICAgICAgICAgaWYgKHN1YnN0aXR1dGlvbkluZGV4IDwgc3Vic3RpdHV0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1YnN0aXR1dGlvbiA9IHN0cmluZ2lmeVNhZmUoXG4gICAgICAgICAgICAgIHN1YnN0aXR1dGlvbnNbc3Vic3RpdHV0aW9uSW5kZXhdLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHN1YnN0aXR1dGlvbk9mZnNldHMucHVzaCh7XG4gICAgICAgICAgICAgIGxlbmd0aDogc3Vic3RpdHV0aW9uLmxlbmd0aCxcbiAgICAgICAgICAgICAgb2Zmc2V0OiBjb250ZW50U3RyaW5nLmxlbmd0aCxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXRlZ29yeVN0cmluZyArPSBTVUJTVElUVVRJT047XG4gICAgICAgICAgICBjb250ZW50U3RyaW5nICs9IHN1YnN0aXR1dGlvbjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3Vic3RpdHV0aW9uT2Zmc2V0cy5wdXNoKHtcbiAgICAgICAgICAgICAgbGVuZ3RoOiAyLFxuICAgICAgICAgICAgICBvZmZzZXQ6IGNvbnRlbnRTdHJpbmcubGVuZ3RoLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhdGVnb3J5U3RyaW5nICs9ICclcyc7XG4gICAgICAgICAgICBjb250ZW50U3RyaW5nICs9ICclcyc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc3Vic3RpdHV0aW9uSW5kZXgrKztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjYXRlZ29yeVBhcnRzLnB1c2goY2F0ZWdvcnlTdHJpbmcpO1xuICAgICAgY29udGVudFBhcnRzLnB1c2goY29udGVudFN0cmluZyk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVtYWluaW5nQXJncyA9IHJlbWFpbmluZy5tYXAoc3RyaW5naWZ5U2FmZSk7XG4gICAgY2F0ZWdvcnlQYXJ0cy5wdXNoKC4uLnJlbWFpbmluZ0FyZ3MpO1xuICAgIGNvbnRlbnRQYXJ0cy5wdXNoKC4uLnJlbWFpbmluZ0FyZ3MpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeVBhcnRzLmpvaW4oJyAnKSxcbiAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgY29udGVudDogY29udGVudFBhcnRzLmpvaW4oJyAnKSxcbiAgICAgICAgc3Vic3RpdHV0aW9uczogc3Vic3RpdHV0aW9uT2Zmc2V0cyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfSxcblxuICByZW5kZXIoXG4gICAge2NvbnRlbnQsIHN1YnN0aXR1dGlvbnN9OiBNZXNzYWdlLFxuICAgIHN1YnN0aXR1dGlvblN0eWxlOiBUZXh0U3R5bGVQcm9wLFxuICApOiBSZWFjdC5Ob2RlIHtcbiAgICBjb25zdCBlbGVtZW50cyA9IFtdO1xuXG4gICAgY29uc3QgbGFzdE9mZnNldCA9IHN1YnN0aXR1dGlvbnMucmVkdWNlKFxuICAgICAgKHByZXZPZmZzZXQsIHN1YnN0aXR1dGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3Qga2V5ID0gU3RyaW5nKGluZGV4KTtcblxuICAgICAgICBpZiAoc3Vic3RpdHV0aW9uLm9mZnNldCA+IHByZXZPZmZzZXQpIHtcbiAgICAgICAgICBjb25zdCBwcmV2UGFydCA9IGNvbnRlbnQuc3Vic3RyKFxuICAgICAgICAgICAgcHJldk9mZnNldCxcbiAgICAgICAgICAgIHN1YnN0aXR1dGlvbi5vZmZzZXQgLSBwcmV2T2Zmc2V0LFxuICAgICAgICAgICk7XG4gICAgICAgICAgZWxlbWVudHMucHVzaCg8VGV4dCBrZXk9e2tleX0+e3ByZXZQYXJ0fTwvVGV4dD4pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc3Vic3RpdGl0aW9uUGFydCA9IGNvbnRlbnQuc3Vic3RyKFxuICAgICAgICAgIHN1YnN0aXR1dGlvbi5vZmZzZXQsXG4gICAgICAgICAgc3Vic3RpdHV0aW9uLmxlbmd0aCxcbiAgICAgICAgKTtcbiAgICAgICAgZWxlbWVudHMucHVzaChcbiAgICAgICAgICA8VGV4dCBrZXk9e2tleSArICcuNSd9IHN0eWxlPXtzdWJzdGl0dXRpb25TdHlsZX0+XG4gICAgICAgICAgICB7c3Vic3RpdGl0aW9uUGFydH1cbiAgICAgICAgICA8L1RleHQ+LFxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBzdWJzdGl0dXRpb24ub2Zmc2V0ICsgc3Vic3RpdHV0aW9uLmxlbmd0aDtcbiAgICAgIH0sXG4gICAgICAwLFxuICAgICk7XG5cbiAgICBpZiAobGFzdE9mZnNldCA8IGNvbnRlbnQubGVuZ3RoKSB7XG4gICAgICBjb25zdCBsYXN0UGFydCA9IGNvbnRlbnQuc3Vic3RyKGxhc3RPZmZzZXQpO1xuICAgICAgZWxlbWVudHMucHVzaCg8VGV4dCBrZXk9XCItMVwiPntsYXN0UGFydH08L1RleHQ+KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZWxlbWVudHM7XG4gIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFllbGxvd0JveENhdGVnb3J5O1xuIl19