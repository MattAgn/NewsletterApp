0096680f1b10d09614fb30b9fd670ab0
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _container;

var AppContainer = require('../ReactNative/AppContainer');

var I18nManager = require('../ReactNative/I18nManager');

var NativeEventEmitter = require('../EventEmitter/NativeEventEmitter');

var NativeModules = require('../BatchedBridge/NativeModules');

var Platform = require('../Utilities/Platform');

var React = require('react');

var PropTypes = require('prop-types');

var StyleSheet = require('../StyleSheet/StyleSheet');

var View = require('../Components/View/View');

var RCTModalHostView = require('./RCTModalHostViewNativeComponent');

var ModalEventEmitter = Platform.OS === 'ios' && NativeModules.ModalManager ? new NativeEventEmitter(NativeModules.ModalManager) : null;
var uniqueModalIdentifier = 0;

var Modal = function (_React$Component) {
  (0, _inherits2.default)(Modal, _React$Component);

  function Modal(props) {
    var _this;

    (0, _classCallCheck2.default)(this, Modal);
    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(Modal).call(this, props));

    Modal._confirmProps(props);

    _this._identifier = uniqueModalIdentifier++;
    return _this;
  }

  (0, _createClass2.default)(Modal, [{
    key: "getChildContext",
    value: function getChildContext() {
      return {
        virtualizedList: null
      };
    }
  }, {
    key: "componentDidMount",
    value: function componentDidMount() {
      var _this2 = this;

      if (ModalEventEmitter) {
        this._eventSubscription = ModalEventEmitter.addListener('modalDismissed', function (event) {
          if (event.modalID === _this2._identifier && _this2.props.onDismiss) {
            _this2.props.onDismiss();
          }
        });
      }
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      if (this._eventSubscription) {
        this._eventSubscription.remove();
      }
    }
  }, {
    key: "UNSAFE_componentWillReceiveProps",
    value: function UNSAFE_componentWillReceiveProps(nextProps) {
      Modal._confirmProps(nextProps);
    }
  }, {
    key: "render",
    value: function render() {
      if (this.props.visible !== true) {
        return null;
      }

      var containerStyles = {
        backgroundColor: this.props.transparent ? 'transparent' : 'white'
      };
      var animationType = this.props.animationType;

      if (!animationType) {
        animationType = 'none';

        if (this.props.animated) {
          animationType = 'slide';
        }
      }

      var presentationStyle = this.props.presentationStyle;

      if (!presentationStyle) {
        presentationStyle = 'fullScreen';

        if (this.props.transparent) {
          presentationStyle = 'overFullScreen';
        }
      }

      var innerChildren = __DEV__ ? React.createElement(AppContainer, {
        rootTag: this.context.rootTag
      }, this.props.children) : this.props.children;
      return React.createElement(RCTModalHostView, {
        animationType: animationType,
        presentationStyle: presentationStyle,
        transparent: this.props.transparent,
        hardwareAccelerated: this.props.hardwareAccelerated,
        onRequestClose: this.props.onRequestClose,
        onShow: this.props.onShow,
        identifier: this._identifier,
        style: styles.modal,
        onStartShouldSetResponder: this._shouldSetResponder,
        supportedOrientations: this.props.supportedOrientations,
        onOrientationChange: this.props.onOrientationChange
      }, React.createElement(View, {
        style: [styles.container, containerStyles]
      }, innerChildren));
    }
  }, {
    key: "_shouldSetResponder",
    value: function _shouldSetResponder() {
      return true;
    }
  }], [{
    key: "_confirmProps",
    value: function _confirmProps(props) {
      if (props.presentationStyle && props.presentationStyle !== 'overFullScreen' && props.transparent) {
        console.warn("Modal with '" + props.presentationStyle + "' presentation style and 'transparent' value is not supported.");
      }
    }
  }]);
  return Modal;
}(React.Component);

Modal.defaultProps = {
  visible: true,
  hardwareAccelerated: false
};
Modal.contextTypes = {
  rootTag: PropTypes.number
};
Modal.childContextTypes = {
  virtualizedList: PropTypes.object
};
var side = I18nManager.isRTL ? 'right' : 'left';
var styles = StyleSheet.create({
  modal: {
    position: 'absolute'
  },
  container: (_container = {}, (0, _defineProperty2.default)(_container, side, 0), (0, _defineProperty2.default)(_container, "top", 0), (0, _defineProperty2.default)(_container, "flex", 1), _container)
});
module.exports = Modal;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1vZGFsLmpzIl0sIm5hbWVzIjpbIkFwcENvbnRhaW5lciIsInJlcXVpcmUiLCJJMThuTWFuYWdlciIsIk5hdGl2ZUV2ZW50RW1pdHRlciIsIk5hdGl2ZU1vZHVsZXMiLCJQbGF0Zm9ybSIsIlJlYWN0IiwiUHJvcFR5cGVzIiwiU3R5bGVTaGVldCIsIlZpZXciLCJSQ1RNb2RhbEhvc3RWaWV3IiwiTW9kYWxFdmVudEVtaXR0ZXIiLCJPUyIsIk1vZGFsTWFuYWdlciIsInVuaXF1ZU1vZGFsSWRlbnRpZmllciIsIk1vZGFsIiwicHJvcHMiLCJfY29uZmlybVByb3BzIiwiX2lkZW50aWZpZXIiLCJ2aXJ0dWFsaXplZExpc3QiLCJfZXZlbnRTdWJzY3JpcHRpb24iLCJhZGRMaXN0ZW5lciIsImV2ZW50IiwibW9kYWxJRCIsIm9uRGlzbWlzcyIsInJlbW92ZSIsIm5leHRQcm9wcyIsInZpc2libGUiLCJjb250YWluZXJTdHlsZXMiLCJiYWNrZ3JvdW5kQ29sb3IiLCJ0cmFuc3BhcmVudCIsImFuaW1hdGlvblR5cGUiLCJhbmltYXRlZCIsInByZXNlbnRhdGlvblN0eWxlIiwiaW5uZXJDaGlsZHJlbiIsIl9fREVWX18iLCJjb250ZXh0Iiwicm9vdFRhZyIsImNoaWxkcmVuIiwiaGFyZHdhcmVBY2NlbGVyYXRlZCIsIm9uUmVxdWVzdENsb3NlIiwib25TaG93Iiwic3R5bGVzIiwibW9kYWwiLCJfc2hvdWxkU2V0UmVzcG9uZGVyIiwic3VwcG9ydGVkT3JpZW50YXRpb25zIiwib25PcmllbnRhdGlvbkNoYW5nZSIsImNvbnRhaW5lciIsImNvbnNvbGUiLCJ3YXJuIiwiQ29tcG9uZW50IiwiZGVmYXVsdFByb3BzIiwiY29udGV4dFR5cGVzIiwibnVtYmVyIiwiY2hpbGRDb250ZXh0VHlwZXMiLCJvYmplY3QiLCJzaWRlIiwiaXNSVEwiLCJjcmVhdGUiLCJwb3NpdGlvbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQVVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7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SWpDLEtBQUssQ0FBQ2lCLGlCQUZWO0FBS0Q7QUFDRjs7O0VBbEVpQjNCLEtBQUssQ0FBQzRDLFM7O0FBQXBCbkMsSyxDQUNHb0MsWSxHQUFlO0FBQ3BCeEIsRUFBQUEsT0FBTyxFQUFFLElBRFc7QUFFcEJZLEVBQUFBLG1CQUFtQixFQUFFO0FBRkQsQztBQURsQnhCLEssQ0FNR3FDLFksR0FBZTtBQUNwQmYsRUFBQUEsT0FBTyxFQUFFOUIsU0FBUyxDQUFDOEM7QUFEQyxDO0FBTmxCdEMsSyxDQW1CR3VDLGlCLEdBQW9CO0FBQ3pCbkMsRUFBQUEsZUFBZSxFQUFFWixTQUFTLENBQUNnRDtBQURGLEM7QUEyRzdCLElBQU1DLElBQUksR0FBR3RELFdBQVcsQ0FBQ3VELEtBQVosR0FBb0IsT0FBcEIsR0FBOEIsTUFBM0M7QUFDQSxJQUFNZixNQUFNLEdBQUdsQyxVQUFVLENBQUNrRCxNQUFYLENBQWtCO0FBQy9CZixFQUFBQSxLQUFLLEVBQUU7QUFDTGdCLElBQUFBLFFBQVEsRUFBRTtBQURMLEdBRHdCO0FBSS9CWixFQUFBQSxTQUFTLDhEQUNOUyxJQURNLEVBQ0MsQ0FERCxvREFFRixDQUZFLHFEQUdELENBSEM7QUFKc0IsQ0FBbEIsQ0FBZjtBQVdBSSxNQUFNLENBQUNDLE9BQVAsR0FBaUI5QyxLQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBGYWNlYm9vaywgSW5jLiBhbmQgaXRzIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZvcm1hdFxuICogQGZsb3dcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IEFwcENvbnRhaW5lciA9IHJlcXVpcmUoJy4uL1JlYWN0TmF0aXZlL0FwcENvbnRhaW5lcicpO1xuY29uc3QgSTE4bk1hbmFnZXIgPSByZXF1aXJlKCcuLi9SZWFjdE5hdGl2ZS9JMThuTWFuYWdlcicpO1xuY29uc3QgTmF0aXZlRXZlbnRFbWl0dGVyID0gcmVxdWlyZSgnLi4vRXZlbnRFbWl0dGVyL05hdGl2ZUV2ZW50RW1pdHRlcicpO1xuY29uc3QgTmF0aXZlTW9kdWxlcyA9IHJlcXVpcmUoJy4uL0JhdGNoZWRCcmlkZ2UvTmF0aXZlTW9kdWxlcycpO1xuY29uc3QgUGxhdGZvcm0gPSByZXF1aXJlKCcuLi9VdGlsaXRpZXMvUGxhdGZvcm0nKTtcbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcbmNvbnN0IFByb3BUeXBlcyA9IHJlcXVpcmUoJ3Byb3AtdHlwZXMnKTtcbmNvbnN0IFN0eWxlU2hlZXQgPSByZXF1aXJlKCcuLi9TdHlsZVNoZWV0L1N0eWxlU2hlZXQnKTtcbmNvbnN0IFZpZXcgPSByZXF1aXJlKCcuLi9Db21wb25lbnRzL1ZpZXcvVmlldycpO1xuXG5jb25zdCBSQ1RNb2RhbEhvc3RWaWV3ID0gcmVxdWlyZSgnLi9SQ1RNb2RhbEhvc3RWaWV3TmF0aXZlQ29tcG9uZW50Jyk7XG5cbmNvbnN0IE1vZGFsRXZlbnRFbWl0dGVyID1cbiAgUGxhdGZvcm0uT1MgPT09ICdpb3MnICYmIE5hdGl2ZU1vZHVsZXMuTW9kYWxNYW5hZ2VyXG4gICAgPyBuZXcgTmF0aXZlRXZlbnRFbWl0dGVyKE5hdGl2ZU1vZHVsZXMuTW9kYWxNYW5hZ2VyKVxuICAgIDogbnVsbDtcblxuaW1wb3J0IHR5cGUgRW1pdHRlclN1YnNjcmlwdGlvbiBmcm9tICcuLi92ZW5kb3IvZW1pdHRlci9FbWl0dGVyU3Vic2NyaXB0aW9uJztcbmltcG9ydCB0eXBlIHtWaWV3UHJvcHN9IGZyb20gJy4uL0NvbXBvbmVudHMvVmlldy9WaWV3UHJvcFR5cGVzJztcbmltcG9ydCB0eXBlIHtTeW50aGV0aWNFdmVudH0gZnJvbSAnLi4vVHlwZXMvQ29yZUV2ZW50VHlwZXMnO1xuXG4vKipcbiAqIFRoZSBNb2RhbCBjb21wb25lbnQgaXMgYSBzaW1wbGUgd2F5IHRvIHByZXNlbnQgY29udGVudCBhYm92ZSBhbiBlbmNsb3Npbmcgdmlldy5cbiAqXG4gKiBTZWUgaHR0cHM6Ly9mYWNlYm9vay5naXRodWIuaW8vcmVhY3QtbmF0aXZlL2RvY3MvbW9kYWwuaHRtbFxuICovXG5cbi8vIEluIG9yZGVyIHRvIHJvdXRlIG9uRGlzbWlzcyBjYWxsYmFja3MsIHdlIG5lZWQgdG8gdW5pcXVlbHkgaWRlbnRpZmllciBlYWNoXG4vLyA8TW9kYWw+IG9uIHNjcmVlbi4gVGhlcmUgY2FuIGJlIGRpZmZlcmVudCBvbmVzLCBlaXRoZXIgbmVzdGVkIG9yIGFzIHNpYmxpbmdzLlxuLy8gV2UgY2Fubm90IHBhc3MgdGhlIG9uRGlzbWlzcyBjYWxsYmFjayB0byBuYXRpdmUgYXMgdGhlIHZpZXcgd2lsbCBiZVxuLy8gZGVzdHJveWVkIGJlZm9yZSB0aGUgY2FsbGJhY2sgaXMgZmlyZWQuXG5sZXQgdW5pcXVlTW9kYWxJZGVudGlmaWVyID0gMDtcblxudHlwZSBPcmllbnRhdGlvbkNoYW5nZUV2ZW50ID0gU3ludGhldGljRXZlbnQ8XG4gICRSZWFkT25seTx7fFxuICAgIG9yaWVudGF0aW9uOiAncG9ydHJhaXQnIHwgJ2xhbmRzY2FwZScsXG4gIHx9Pixcbj47XG5cbnR5cGUgUHJvcHMgPSAkUmVhZE9ubHk8e3xcbiAgLi4uVmlld1Byb3BzLFxuXG4gIC8qKlxuICAgKiBUaGUgYGFuaW1hdGlvblR5cGVgIHByb3AgY29udHJvbHMgaG93IHRoZSBtb2RhbCBhbmltYXRlcy5cbiAgICpcbiAgICogU2VlIGh0dHBzOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL21vZGFsLmh0bWwjYW5pbWF0aW9udHlwZVxuICAgKi9cbiAgYW5pbWF0aW9uVHlwZT86ID8oJ25vbmUnIHwgJ3NsaWRlJyB8ICdmYWRlJyksXG5cbiAgLyoqXG4gICAqIFRoZSBgcHJlc2VudGF0aW9uU3R5bGVgIHByb3AgY29udHJvbHMgaG93IHRoZSBtb2RhbCBhcHBlYXJzLlxuICAgKlxuICAgKiBTZWUgaHR0cHM6Ly9mYWNlYm9vay5naXRodWIuaW8vcmVhY3QtbmF0aXZlL2RvY3MvbW9kYWwuaHRtbCNwcmVzZW50YXRpb25zdHlsZVxuICAgKi9cbiAgcHJlc2VudGF0aW9uU3R5bGU/OiA/KFxuICAgIHwgJ2Z1bGxTY3JlZW4nXG4gICAgfCAncGFnZVNoZWV0J1xuICAgIHwgJ2Zvcm1TaGVldCdcbiAgICB8ICdvdmVyRnVsbFNjcmVlbidcbiAgKSxcblxuICAvKipcbiAgICogVGhlIGB0cmFuc3BhcmVudGAgcHJvcCBkZXRlcm1pbmVzIHdoZXRoZXIgeW91ciBtb2RhbCB3aWxsIGZpbGwgdGhlXG4gICAqIGVudGlyZSB2aWV3LlxuICAgKlxuICAgKiBTZWUgaHR0cHM6Ly9mYWNlYm9vay5naXRodWIuaW8vcmVhY3QtbmF0aXZlL2RvY3MvbW9kYWwuaHRtbCN0cmFuc3BhcmVudFxuICAgKi9cbiAgdHJhbnNwYXJlbnQ/OiA/Ym9vbGVhbixcblxuICAvKipcbiAgICogVGhlIGBoYXJkd2FyZUFjY2VsZXJhdGVkYCBwcm9wIGNvbnRyb2xzIHdoZXRoZXIgdG8gZm9yY2UgaGFyZHdhcmVcbiAgICogYWNjZWxlcmF0aW9uIGZvciB0aGUgdW5kZXJseWluZyB3aW5kb3cuXG4gICAqXG4gICAqIFNlZSBodHRwczovL2ZhY2Vib29rLmdpdGh1Yi5pby9yZWFjdC1uYXRpdmUvZG9jcy9tb2RhbC5odG1sI2hhcmR3YXJlYWNjZWxlcmF0ZWRcbiAgICovXG4gIGhhcmR3YXJlQWNjZWxlcmF0ZWQ/OiA/Ym9vbGVhbixcblxuICAvKipcbiAgICogVGhlIGB2aXNpYmxlYCBwcm9wIGRldGVybWluZXMgd2hldGhlciB5b3VyIG1vZGFsIGlzIHZpc2libGUuXG4gICAqXG4gICAqIFNlZSBodHRwczovL2ZhY2Vib29rLmdpdGh1Yi5pby9yZWFjdC1uYXRpdmUvZG9jcy9tb2RhbC5odG1sI3Zpc2libGVcbiAgICovXG4gIHZpc2libGU/OiA/Ym9vbGVhbixcblxuICAvKipcbiAgICogVGhlIGBvblJlcXVlc3RDbG9zZWAgY2FsbGJhY2sgaXMgY2FsbGVkIHdoZW4gdGhlIHVzZXIgdGFwcyB0aGUgaGFyZHdhcmVcbiAgICogYmFjayBidXR0b24gb24gQW5kcm9pZCBvciB0aGUgbWVudSBidXR0b24gb24gQXBwbGUgVFYuXG4gICAqXG4gICAqIFRoaXMgaXMgcmVxdWlyZWQgb24gQXBwbGUgVFYgYW5kIEFuZHJvaWQuXG4gICAqXG4gICAqIFNlZSBodHRwczovL2ZhY2Vib29rLmdpdGh1Yi5pby9yZWFjdC1uYXRpdmUvZG9jcy9tb2RhbC5odG1sI29ucmVxdWVzdGNsb3NlXG4gICAqL1xuICBvblJlcXVlc3RDbG9zZT86ID8oZXZlbnQ/OiBTeW50aGV0aWNFdmVudDxudWxsPikgPT4gbWl4ZWQsXG5cbiAgLyoqXG4gICAqIFRoZSBgb25TaG93YCBwcm9wIGFsbG93cyBwYXNzaW5nIGEgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCBvbmNlIHRoZVxuICAgKiBtb2RhbCBoYXMgYmVlbiBzaG93bi5cbiAgICpcbiAgICogU2VlIGh0dHBzOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL21vZGFsLmh0bWwjb25zaG93XG4gICAqL1xuICBvblNob3c/OiA/KGV2ZW50PzogU3ludGhldGljRXZlbnQ8bnVsbD4pID0+IG1peGVkLFxuXG4gIC8qKlxuICAgKiBUaGUgYG9uRGlzbWlzc2AgcHJvcCBhbGxvd3MgcGFzc2luZyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgb25jZVxuICAgKiB0aGUgbW9kYWwgaGFzIGJlZW4gZGlzbWlzc2VkLlxuICAgKlxuICAgKiBTZWUgaHR0cHM6Ly9mYWNlYm9vay5naXRodWIuaW8vcmVhY3QtbmF0aXZlL2RvY3MvbW9kYWwuaHRtbCNvbmRpc21pc3NcbiAgICovXG4gIG9uRGlzbWlzcz86ID8oKSA9PiBtaXhlZCxcblxuICAvKipcbiAgICogRGVwcmVjYXRlZC4gVXNlIHRoZSBgYW5pbWF0aW9uVHlwZWAgcHJvcCBpbnN0ZWFkLlxuICAgKi9cbiAgYW5pbWF0ZWQ/OiA/Ym9vbGVhbixcblxuICAvKipcbiAgICogVGhlIGBzdXBwb3J0ZWRPcmllbnRhdGlvbnNgIHByb3AgYWxsb3dzIHRoZSBtb2RhbCB0byBiZSByb3RhdGVkIHRvIGFueSBvZiB0aGUgc3BlY2lmaWVkIG9yaWVudGF0aW9ucy5cbiAgICpcbiAgICogU2VlIGh0dHBzOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL21vZGFsLmh0bWwjc3VwcG9ydGVkb3JpZW50YXRpb25zXG4gICAqL1xuICBzdXBwb3J0ZWRPcmllbnRhdGlvbnM/OiA/JFJlYWRPbmx5QXJyYXk8XG4gICAgfCAncG9ydHJhaXQnXG4gICAgfCAncG9ydHJhaXQtdXBzaWRlLWRvd24nXG4gICAgfCAnbGFuZHNjYXBlJ1xuICAgIHwgJ2xhbmRzY2FwZS1sZWZ0J1xuICAgIHwgJ2xhbmRzY2FwZS1yaWdodCcsXG4gID4sXG5cbiAgLyoqXG4gICAqIFRoZSBgb25PcmllbnRhdGlvbkNoYW5nZWAgY2FsbGJhY2sgaXMgY2FsbGVkIHdoZW4gdGhlIG9yaWVudGF0aW9uIGNoYW5nZXMgd2hpbGUgdGhlIG1vZGFsIGlzIGJlaW5nIGRpc3BsYXllZC5cbiAgICpcbiAgICogU2VlIGh0dHBzOi8vZmFjZWJvb2suZ2l0aHViLmlvL3JlYWN0LW5hdGl2ZS9kb2NzL21vZGFsLmh0bWwjb25vcmllbnRhdGlvbmNoYW5nZVxuICAgKi9cbiAgb25PcmllbnRhdGlvbkNoYW5nZT86ID8oZXZlbnQ6IE9yaWVudGF0aW9uQ2hhbmdlRXZlbnQpID0+IG1peGVkLFxufH0+O1xuXG5jbGFzcyBNb2RhbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIHZpc2libGU6IHRydWUsXG4gICAgaGFyZHdhcmVBY2NlbGVyYXRlZDogZmFsc2UsXG4gIH07XG5cbiAgc3RhdGljIGNvbnRleHRUeXBlcyA9IHtcbiAgICByb290VGFnOiBQcm9wVHlwZXMubnVtYmVyLFxuICB9O1xuXG4gIF9pZGVudGlmaWVyOiBudW1iZXI7XG4gIF9ldmVudFN1YnNjcmlwdGlvbjogP0VtaXR0ZXJTdWJzY3JpcHRpb247XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIE1vZGFsLl9jb25maXJtUHJvcHMocHJvcHMpO1xuICAgIHRoaXMuX2lkZW50aWZpZXIgPSB1bmlxdWVNb2RhbElkZW50aWZpZXIrKztcbiAgfVxuXG4gIHN0YXRpYyBjaGlsZENvbnRleHRUeXBlcyA9IHtcbiAgICB2aXJ0dWFsaXplZExpc3Q6IFByb3BUeXBlcy5vYmplY3QsXG4gIH07XG5cbiAgZ2V0Q2hpbGRDb250ZXh0KCkge1xuICAgIC8vIFJlc2V0IHRoZSBjb250ZXh0IHNvIFZpcnR1YWxpemVkTGlzdCBkb2Vzbid0IGdldCBjb25mdXNlZCBieSBuZXN0aW5nXG4gICAgLy8gaW4gdGhlIFJlYWN0IHRyZWUgdGhhdCBkb2Vzbid0IHJlZmxlY3QgdGhlIG5hdGl2ZSBjb21wb25lbnQgaGVpcmFyY2h5LlxuICAgIHJldHVybiB7XG4gICAgICB2aXJ0dWFsaXplZExpc3Q6IG51bGwsXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGlmIChNb2RhbEV2ZW50RW1pdHRlcikge1xuICAgICAgdGhpcy5fZXZlbnRTdWJzY3JpcHRpb24gPSBNb2RhbEV2ZW50RW1pdHRlci5hZGRMaXN0ZW5lcihcbiAgICAgICAgJ21vZGFsRGlzbWlzc2VkJyxcbiAgICAgICAgZXZlbnQgPT4ge1xuICAgICAgICAgIGlmIChldmVudC5tb2RhbElEID09PSB0aGlzLl9pZGVudGlmaWVyICYmIHRoaXMucHJvcHMub25EaXNtaXNzKSB7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uRGlzbWlzcygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgaWYgKHRoaXMuX2V2ZW50U3Vic2NyaXB0aW9uKSB7XG4gICAgICB0aGlzLl9ldmVudFN1YnNjcmlwdGlvbi5yZW1vdmUoKTtcbiAgICB9XG4gIH1cblxuICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHM6IFByb3BzKSB7XG4gICAgTW9kYWwuX2NvbmZpcm1Qcm9wcyhuZXh0UHJvcHMpO1xuICB9XG5cbiAgc3RhdGljIF9jb25maXJtUHJvcHMocHJvcHM6IFByb3BzKSB7XG4gICAgaWYgKFxuICAgICAgcHJvcHMucHJlc2VudGF0aW9uU3R5bGUgJiZcbiAgICAgIHByb3BzLnByZXNlbnRhdGlvblN0eWxlICE9PSAnb3ZlckZ1bGxTY3JlZW4nICYmXG4gICAgICBwcm9wcy50cmFuc3BhcmVudFxuICAgICkge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICBgTW9kYWwgd2l0aCAnJHtcbiAgICAgICAgICBwcm9wcy5wcmVzZW50YXRpb25TdHlsZVxuICAgICAgICB9JyBwcmVzZW50YXRpb24gc3R5bGUgYW5kICd0cmFuc3BhcmVudCcgdmFsdWUgaXMgbm90IHN1cHBvcnRlZC5gLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICByZW5kZXIoKTogUmVhY3QuTm9kZSB7XG4gICAgaWYgKHRoaXMucHJvcHMudmlzaWJsZSAhPT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgY29udGFpbmVyU3R5bGVzID0ge1xuICAgICAgYmFja2dyb3VuZENvbG9yOiB0aGlzLnByb3BzLnRyYW5zcGFyZW50ID8gJ3RyYW5zcGFyZW50JyA6ICd3aGl0ZScsXG4gICAgfTtcblxuICAgIGxldCBhbmltYXRpb25UeXBlID0gdGhpcy5wcm9wcy5hbmltYXRpb25UeXBlO1xuICAgIGlmICghYW5pbWF0aW9uVHlwZSkge1xuICAgICAgLy8gbWFudWFsbHkgc2V0dGluZyBkZWZhdWx0IHByb3AgaGVyZSB0byBrZWVwIHN1cHBvcnQgZm9yIHRoZSBkZXByZWNhdGVkICdhbmltYXRlZCcgcHJvcFxuICAgICAgYW5pbWF0aW9uVHlwZSA9ICdub25lJztcbiAgICAgIGlmICh0aGlzLnByb3BzLmFuaW1hdGVkKSB7XG4gICAgICAgIGFuaW1hdGlvblR5cGUgPSAnc2xpZGUnO1xuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBwcmVzZW50YXRpb25TdHlsZSA9IHRoaXMucHJvcHMucHJlc2VudGF0aW9uU3R5bGU7XG4gICAgaWYgKCFwcmVzZW50YXRpb25TdHlsZSkge1xuICAgICAgcHJlc2VudGF0aW9uU3R5bGUgPSAnZnVsbFNjcmVlbic7XG4gICAgICBpZiAodGhpcy5wcm9wcy50cmFuc3BhcmVudCkge1xuICAgICAgICBwcmVzZW50YXRpb25TdHlsZSA9ICdvdmVyRnVsbFNjcmVlbic7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgaW5uZXJDaGlsZHJlbiA9IF9fREVWX18gPyAoXG4gICAgICA8QXBwQ29udGFpbmVyIHJvb3RUYWc9e3RoaXMuY29udGV4dC5yb290VGFnfT5cbiAgICAgICAge3RoaXMucHJvcHMuY2hpbGRyZW59XG4gICAgICA8L0FwcENvbnRhaW5lcj5cbiAgICApIDogKFxuICAgICAgdGhpcy5wcm9wcy5jaGlsZHJlblxuICAgICk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFJDVE1vZGFsSG9zdFZpZXdcbiAgICAgICAgYW5pbWF0aW9uVHlwZT17YW5pbWF0aW9uVHlwZX1cbiAgICAgICAgcHJlc2VudGF0aW9uU3R5bGU9e3ByZXNlbnRhdGlvblN0eWxlfVxuICAgICAgICB0cmFuc3BhcmVudD17dGhpcy5wcm9wcy50cmFuc3BhcmVudH1cbiAgICAgICAgaGFyZHdhcmVBY2NlbGVyYXRlZD17dGhpcy5wcm9wcy5oYXJkd2FyZUFjY2VsZXJhdGVkfVxuICAgICAgICBvblJlcXVlc3RDbG9zZT17dGhpcy5wcm9wcy5vblJlcXVlc3RDbG9zZX1cbiAgICAgICAgb25TaG93PXt0aGlzLnByb3BzLm9uU2hvd31cbiAgICAgICAgaWRlbnRpZmllcj17dGhpcy5faWRlbnRpZmllcn1cbiAgICAgICAgc3R5bGU9e3N0eWxlcy5tb2RhbH1cbiAgICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcj17dGhpcy5fc2hvdWxkU2V0UmVzcG9uZGVyfVxuICAgICAgICBzdXBwb3J0ZWRPcmllbnRhdGlvbnM9e3RoaXMucHJvcHMuc3VwcG9ydGVkT3JpZW50YXRpb25zfVxuICAgICAgICBvbk9yaWVudGF0aW9uQ2hhbmdlPXt0aGlzLnByb3BzLm9uT3JpZW50YXRpb25DaGFuZ2V9PlxuICAgICAgICA8VmlldyBzdHlsZT17W3N0eWxlcy5jb250YWluZXIsIGNvbnRhaW5lclN0eWxlc119Pntpbm5lckNoaWxkcmVufTwvVmlldz5cbiAgICAgIDwvUkNUTW9kYWxIb3N0Vmlldz5cbiAgICApO1xuICB9XG5cbiAgLy8gV2UgZG9uJ3Qgd2FudCBhbnkgcmVzcG9uZGVyIGV2ZW50cyBidWJibGluZyBvdXQgb2YgdGhlIG1vZGFsLlxuICBfc2hvdWxkU2V0UmVzcG9uZGVyKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cbmNvbnN0IHNpZGUgPSBJMThuTWFuYWdlci5pc1JUTCA/ICdyaWdodCcgOiAnbGVmdCc7XG5jb25zdCBzdHlsZXMgPSBTdHlsZVNoZWV0LmNyZWF0ZSh7XG4gIG1vZGFsOiB7XG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gIH0sXG4gIGNvbnRhaW5lcjoge1xuICAgIFtzaWRlXTogMCxcbiAgICB0b3A6IDAsXG4gICAgZmxleDogMSxcbiAgfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1vZGFsO1xuIl19