506e9c6c4866a0afefee0a8e88aa63b9
"use strict";

var BOMChar = "\uFEFF";
exports.PrependBOM = PrependBOMWrapper;

function PrependBOMWrapper(encoder, options) {
  this.encoder = encoder;
  this.addBOM = true;
}

PrependBOMWrapper.prototype.write = function (str) {
  if (this.addBOM) {
    str = BOMChar + str;
    this.addBOM = false;
  }

  return this.encoder.write(str);
};

PrependBOMWrapper.prototype.end = function () {
  return this.encoder.end();
};

exports.StripBOM = StripBOMWrapper;

function StripBOMWrapper(decoder, options) {
  this.decoder = decoder;
  this.pass = false;
  this.options = options || {};
}

StripBOMWrapper.prototype.write = function (buf) {
  var res = this.decoder.write(buf);
  if (this.pass || !res) return res;

  if (res[0] === BOMChar) {
    res = res.slice(1);
    if (typeof this.options.stripBOM === 'function') this.options.stripBOM();
  }

  this.pass = true;
  return res;
};

StripBOMWrapper.prototype.end = function () {
  return this.decoder.end();
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvbS1oYW5kbGluZy5qcyJdLCJuYW1lcyI6WyJCT01DaGFyIiwiZXhwb3J0cyIsIlByZXBlbmRCT00iLCJQcmVwZW5kQk9NV3JhcHBlciIsImVuY29kZXIiLCJvcHRpb25zIiwiYWRkQk9NIiwicHJvdG90eXBlIiwid3JpdGUiLCJzdHIiLCJlbmQiLCJTdHJpcEJPTSIsIlN0cmlwQk9NV3JhcHBlciIsImRlY29kZXIiLCJwYXNzIiwiYnVmIiwicmVzIiwic2xpY2UiLCJzdHJpcEJPTSJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBSUEsT0FBTyxHQUFHLFFBQWQ7QUFFQUMsT0FBTyxDQUFDQyxVQUFSLEdBQXFCQyxpQkFBckI7O0FBQ0EsU0FBU0EsaUJBQVQsQ0FBMkJDLE9BQTNCLEVBQW9DQyxPQUFwQyxFQUE2QztBQUN6QyxPQUFLRCxPQUFMLEdBQWVBLE9BQWY7QUFDQSxPQUFLRSxNQUFMLEdBQWMsSUFBZDtBQUNIOztBQUVESCxpQkFBaUIsQ0FBQ0ksU0FBbEIsQ0FBNEJDLEtBQTVCLEdBQW9DLFVBQVNDLEdBQVQsRUFBYztBQUM5QyxNQUFJLEtBQUtILE1BQVQsRUFBaUI7QUFDYkcsSUFBQUEsR0FBRyxHQUFHVCxPQUFPLEdBQUdTLEdBQWhCO0FBQ0EsU0FBS0gsTUFBTCxHQUFjLEtBQWQ7QUFDSDs7QUFFRCxTQUFPLEtBQUtGLE9BQUwsQ0FBYUksS0FBYixDQUFtQkMsR0FBbkIsQ0FBUDtBQUNILENBUEQ7O0FBU0FOLGlCQUFpQixDQUFDSSxTQUFsQixDQUE0QkcsR0FBNUIsR0FBa0MsWUFBVztBQUN6QyxTQUFPLEtBQUtOLE9BQUwsQ0FBYU0sR0FBYixFQUFQO0FBQ0gsQ0FGRDs7QUFPQVQsT0FBTyxDQUFDVSxRQUFSLEdBQW1CQyxlQUFuQjs7QUFDQSxTQUFTQSxlQUFULENBQXlCQyxPQUF6QixFQUFrQ1IsT0FBbEMsRUFBMkM7QUFDdkMsT0FBS1EsT0FBTCxHQUFlQSxPQUFmO0FBQ0EsT0FBS0MsSUFBTCxHQUFZLEtBQVo7QUFDQSxPQUFLVCxPQUFMLEdBQWVBLE9BQU8sSUFBSSxFQUExQjtBQUNIOztBQUVETyxlQUFlLENBQUNMLFNBQWhCLENBQTBCQyxLQUExQixHQUFrQyxVQUFTTyxHQUFULEVBQWM7QUFDNUMsTUFBSUMsR0FBRyxHQUFHLEtBQUtILE9BQUwsQ0FBYUwsS0FBYixDQUFtQk8sR0FBbkIsQ0FBVjtBQUNBLE1BQUksS0FBS0QsSUFBTCxJQUFhLENBQUNFLEdBQWxCLEVBQ0ksT0FBT0EsR0FBUDs7QUFFSixNQUFJQSxHQUFHLENBQUMsQ0FBRCxDQUFILEtBQVdoQixPQUFmLEVBQXdCO0FBQ3BCZ0IsSUFBQUEsR0FBRyxHQUFHQSxHQUFHLENBQUNDLEtBQUosQ0FBVSxDQUFWLENBQU47QUFDQSxRQUFJLE9BQU8sS0FBS1osT0FBTCxDQUFhYSxRQUFwQixLQUFpQyxVQUFyQyxFQUNJLEtBQUtiLE9BQUwsQ0FBYWEsUUFBYjtBQUNQOztBQUVELE9BQUtKLElBQUwsR0FBWSxJQUFaO0FBQ0EsU0FBT0UsR0FBUDtBQUNILENBYkQ7O0FBZUFKLGVBQWUsQ0FBQ0wsU0FBaEIsQ0FBMEJHLEdBQTFCLEdBQWdDLFlBQVc7QUFDdkMsU0FBTyxLQUFLRyxPQUFMLENBQWFILEdBQWIsRUFBUDtBQUNILENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxudmFyIEJPTUNoYXIgPSAnXFx1RkVGRic7XG5cbmV4cG9ydHMuUHJlcGVuZEJPTSA9IFByZXBlbmRCT01XcmFwcGVyXG5mdW5jdGlvbiBQcmVwZW5kQk9NV3JhcHBlcihlbmNvZGVyLCBvcHRpb25zKSB7XG4gICAgdGhpcy5lbmNvZGVyID0gZW5jb2RlcjtcbiAgICB0aGlzLmFkZEJPTSA9IHRydWU7XG59XG5cblByZXBlbmRCT01XcmFwcGVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKHN0cikge1xuICAgIGlmICh0aGlzLmFkZEJPTSkge1xuICAgICAgICBzdHIgPSBCT01DaGFyICsgc3RyO1xuICAgICAgICB0aGlzLmFkZEJPTSA9IGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmVuY29kZXIud3JpdGUoc3RyKTtcbn1cblxuUHJlcGVuZEJPTVdyYXBwZXIucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmVuY29kZXIuZW5kKCk7XG59XG5cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZXhwb3J0cy5TdHJpcEJPTSA9IFN0cmlwQk9NV3JhcHBlcjtcbmZ1bmN0aW9uIFN0cmlwQk9NV3JhcHBlcihkZWNvZGVyLCBvcHRpb25zKSB7XG4gICAgdGhpcy5kZWNvZGVyID0gZGVjb2RlcjtcbiAgICB0aGlzLnBhc3MgPSBmYWxzZTtcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xufVxuXG5TdHJpcEJPTVdyYXBwZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24oYnVmKSB7XG4gICAgdmFyIHJlcyA9IHRoaXMuZGVjb2Rlci53cml0ZShidWYpO1xuICAgIGlmICh0aGlzLnBhc3MgfHwgIXJlcylcbiAgICAgICAgcmV0dXJuIHJlcztcblxuICAgIGlmIChyZXNbMF0gPT09IEJPTUNoYXIpIHtcbiAgICAgICAgcmVzID0gcmVzLnNsaWNlKDEpO1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5zdHJpcEJPTSA9PT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5zdHJpcEJPTSgpO1xuICAgIH1cblxuICAgIHRoaXMucGFzcyA9IHRydWU7XG4gICAgcmV0dXJuIHJlcztcbn1cblxuU3RyaXBCT01XcmFwcGVyLnByb3RvdHlwZS5lbmQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5kZWNvZGVyLmVuZCgpO1xufVxuXG4iXX0=