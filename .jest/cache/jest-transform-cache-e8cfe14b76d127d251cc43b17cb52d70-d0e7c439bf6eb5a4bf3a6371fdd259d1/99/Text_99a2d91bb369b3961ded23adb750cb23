deafa145b614f9ef50f29d92b2809961
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var DeprecatedTextPropTypes = require('../DeprecatedPropTypes/DeprecatedTextPropTypes');

var React = require('react');

var ReactNativeViewAttributes = require('../Components/View/ReactNativeViewAttributes');

var TextAncestor = require('./TextAncestor');

var Touchable = require('../Components/Touchable/Touchable');

var UIManager = require('../ReactNative/UIManager');

var createReactNativeComponentClass = require('../Renderer/shims/createReactNativeComponentClass');

var nullthrows = require('nullthrows');

var processColor = require('../StyleSheet/processColor');

var PRESS_RECT_OFFSET = {
  top: 20,
  left: 20,
  right: 20,
  bottom: 30
};
var viewConfig = {
  validAttributes: _objectSpread({}, ReactNativeViewAttributes.UIView, {
    isHighlighted: true,
    numberOfLines: true,
    ellipsizeMode: true,
    allowFontScaling: true,
    maxFontSizeMultiplier: true,
    disabled: true,
    selectable: true,
    selectionColor: true,
    adjustsFontSizeToFit: true,
    minimumFontScale: true,
    textBreakStrategy: true,
    onTextLayout: true,
    onInlineViewLayout: true,
    dataDetectorType: true
  }),
  directEventTypes: {
    topTextLayout: {
      registrationName: 'onTextLayout'
    },
    topInlineViewLayout: {
      registrationName: 'onInlineViewLayout'
    }
  },
  uiViewClassName: 'RCTText'
};

var TouchableText = function (_React$Component) {
  (0, _inherits2.default)(TouchableText, _React$Component);

  function TouchableText() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2.default)(this, TouchableText);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(TouchableText)).call.apply(_getPrototypeOf2, [this].concat(args)));
    _this.state = _objectSpread({}, Touchable.Mixin.touchableGetInitialState(), {
      isHighlighted: false,
      createResponderHandlers: _this._createResponseHandlers.bind((0, _assertThisInitialized2.default)(_this)),
      responseHandlers: null
    });
    return _this;
  }

  (0, _createClass2.default)(TouchableText, [{
    key: "render",
    value: function render() {
      var props = this.props;

      if (isTouchable(props)) {
        props = _objectSpread({}, props, {}, this.state.responseHandlers, {
          isHighlighted: this.state.isHighlighted
        });
      }

      if (props.selectionColor != null) {
        props = _objectSpread({}, props, {
          selectionColor: processColor(props.selectionColor)
        });
      }

      if (__DEV__) {
        if (Touchable.TOUCH_TARGET_DEBUG && props.onPress != null) {
          props = _objectSpread({}, props, {
            style: [props.style, {
              color: 'magenta'
            }]
          });
        }
      }

      return React.createElement(TextAncestor.Consumer, null, function (hasTextAncestor) {
        return hasTextAncestor ? React.createElement(RCTVirtualText, (0, _extends2.default)({}, props, {
          ref: props.forwardedRef
        })) : React.createElement(TextAncestor.Provider, {
          value: true
        }, React.createElement(RCTText, (0, _extends2.default)({}, props, {
          ref: props.forwardedRef
        })));
      });
    }
  }, {
    key: "_createResponseHandlers",
    value: function _createResponseHandlers() {
      var _this2 = this;

      return {
        onStartShouldSetResponder: function onStartShouldSetResponder() {
          var onStartShouldSetResponder = _this2.props.onStartShouldSetResponder;
          var shouldSetResponder = (onStartShouldSetResponder == null ? false : onStartShouldSetResponder()) || isTouchable(_this2.props);

          if (shouldSetResponder) {
            _this2._attachTouchHandlers();
          }

          return shouldSetResponder;
        },
        onResponderGrant: function onResponderGrant(event, dispatchID) {
          nullthrows(_this2.touchableHandleResponderGrant)(event, dispatchID);

          if (_this2.props.onResponderGrant != null) {
            _this2.props.onResponderGrant.call(_this2, event, dispatchID);
          }
        },
        onResponderMove: function onResponderMove(event) {
          nullthrows(_this2.touchableHandleResponderMove)(event);

          if (_this2.props.onResponderMove != null) {
            _this2.props.onResponderMove.call(_this2, event);
          }
        },
        onResponderRelease: function onResponderRelease(event) {
          nullthrows(_this2.touchableHandleResponderRelease)(event);

          if (_this2.props.onResponderRelease != null) {
            _this2.props.onResponderRelease.call(_this2, event);
          }
        },
        onResponderTerminate: function onResponderTerminate(event) {
          nullthrows(_this2.touchableHandleResponderTerminate)(event);

          if (_this2.props.onResponderTerminate != null) {
            _this2.props.onResponderTerminate.call(_this2, event);
          }
        },
        onResponderTerminationRequest: function onResponderTerminationRequest() {
          var onResponderTerminationRequest = _this2.props.onResponderTerminationRequest;

          if (!nullthrows(_this2.touchableHandleResponderTerminationRequest)()) {
            return false;
          }

          if (onResponderTerminationRequest == null) {
            return true;
          }

          return onResponderTerminationRequest();
        }
      };
    }
  }, {
    key: "_attachTouchHandlers",
    value: function _attachTouchHandlers() {
      var _this3 = this;

      if (this.touchableGetPressRectOffset != null) {
        return;
      }

      for (var key in Touchable.Mixin) {
        if (typeof Touchable.Mixin[key] === 'function') {
          this[key] = Touchable.Mixin[key].bind(this);
        }
      }

      this.touchableHandleActivePressIn = function () {
        if (!_this3.props.suppressHighlighting && isTouchable(_this3.props)) {
          _this3.setState({
            isHighlighted: true
          });
        }
      };

      this.touchableHandleActivePressOut = function () {
        if (!_this3.props.suppressHighlighting && isTouchable(_this3.props)) {
          _this3.setState({
            isHighlighted: false
          });
        }
      };

      this.touchableHandlePress = function (event) {
        if (_this3.props.onPress != null) {
          _this3.props.onPress(event);
        }
      };

      this.touchableHandleLongPress = function (event) {
        if (_this3.props.onLongPress != null) {
          _this3.props.onLongPress(event);
        }
      };

      this.touchableGetPressRectOffset = function () {
        return _this3.props.pressRetentionOffset == null ? PRESS_RECT_OFFSET : _this3.props.pressRetentionOffset;
      };
    }
  }], [{
    key: "getDerivedStateFromProps",
    value: function getDerivedStateFromProps(nextProps, prevState) {
      return prevState.responseHandlers == null && isTouchable(nextProps) ? {
        responseHandlers: prevState.createResponderHandlers()
      } : null;
    }
  }]);
  return TouchableText;
}(React.Component);

TouchableText.defaultProps = {
  accessible: true,
  allowFontScaling: true,
  ellipsizeMode: 'tail'
};
TouchableText.viewConfig = viewConfig;

var isTouchable = function isTouchable(props) {
  return props.onPress != null || props.onLongPress != null || props.onStartShouldSetResponder != null;
};

var RCTText = createReactNativeComponentClass(viewConfig.uiViewClassName, function () {
  return viewConfig;
});
var RCTVirtualText = UIManager.getViewManagerConfig('RCTVirtualText') == null ? RCTText : createReactNativeComponentClass('RCTVirtualText', function () {
  return {
    validAttributes: _objectSpread({}, ReactNativeViewAttributes.UIView, {
      isHighlighted: true,
      maxFontSizeMultiplier: true
    }),
    uiViewClassName: 'RCTVirtualText'
  };
});

var Text = function Text(props, forwardedRef) {
  return React.createElement(TouchableText, (0, _extends2.default)({}, props, {
    forwardedRef: forwardedRef
  }));
};

var TextToExport = React.forwardRef(Text);
TextToExport.displayName = 'Text';
TextToExport.propTypes = DeprecatedTextPropTypes;
module.exports = TextToExport;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRleHQuanMiXSwibmFtZXMiOlsiRGVwcmVjYXRlZFRleHRQcm9wVHlwZXMiLCJyZXF1aXJlIiwiUmVhY3QiLCJSZWFjdE5hdGl2ZVZpZXdBdHRyaWJ1dGVzIiwiVGV4dEFuY2VzdG9yIiwiVG91Y2hhYmxlIiwiVUlNYW5hZ2VyIiwiY3JlYXRlUmVhY3ROYXRpdmVDb21wb25lbnRDbGFzcyIsIm51bGx0aHJvd3MiLCJwcm9jZXNzQ29sb3IiLCJQUkVTU19SRUNUX09GRlNFVCIsInRvcCIsImxlZnQiLCJyaWdodCIsImJvdHRvbSIsInZpZXdDb25maWciLCJ2YWxpZEF0dHJpYnV0ZXMiLCJVSVZpZXciLCJpc0hpZ2hsaWdodGVkIiwibnVtYmVyT2ZMaW5lcyIsImVsbGlwc2l6ZU1vZGUiLCJhbGxvd0ZvbnRTY2FsaW5nIiwibWF4Rm9udFNpemVNdWx0aXBsaWVyIiwiZGlzYWJsZWQiLCJzZWxlY3RhYmxlIiwic2VsZWN0aW9uQ29sb3IiLCJhZGp1c3RzRm9udFNpemVUb0ZpdCIsIm1pbmltdW1Gb250U2NhbGUiLCJ0ZXh0QnJlYWtTdHJhdGVneSIsIm9uVGV4dExheW91dCIsIm9uSW5saW5lVmlld0xheW91dCIsImRhdGFEZXRlY3RvclR5cGUiLCJkaXJlY3RFdmVudFR5cGVzIiwidG9wVGV4dExheW91dCIsInJlZ2lzdHJhdGlvbk5hbWUiLCJ0b3BJbmxpbmVWaWV3TGF5b3V0IiwidWlWaWV3Q2xhc3NOYW1lIiwiVG91Y2hhYmxlVGV4dCIsInN0YXRlIiwiTWl4aW4iLCJ0b3VjaGFibGVHZXRJbml0aWFsU3RhdGUiLCJjcmVhdGVSZXNwb25kZXJIYW5kbGVycyIsIl9jcmVhdGVSZXNwb25zZUhhbmRsZXJzIiwiYmluZCIsInJlc3BvbnNlSGFuZGxlcnMiLCJwcm9wcyIsImlzVG91Y2hhYmxlIiwiX19ERVZfXyIsIlRPVUNIX1RBUkdFVF9ERUJVRyIsIm9uUHJlc3MiLCJzdHlsZSIsImNvbG9yIiwiaGFzVGV4dEFuY2VzdG9yIiwiZm9yd2FyZGVkUmVmIiwib25TdGFydFNob3VsZFNldFJlc3BvbmRlciIsInNob3VsZFNldFJlc3BvbmRlciIsIl9hdHRhY2hUb3VjaEhhbmRsZXJzIiwib25SZXNwb25kZXJHcmFudCIsImV2ZW50IiwiZGlzcGF0Y2hJRCIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlckdyYW50IiwiY2FsbCIsIm9uUmVzcG9uZGVyTW92ZSIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlck1vdmUiLCJvblJlc3BvbmRlclJlbGVhc2UiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJSZWxlYXNlIiwib25SZXNwb25kZXJUZXJtaW5hdGUiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGUiLCJvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCIsInRvdWNoYWJsZUdldFByZXNzUmVjdE9mZnNldCIsImtleSIsInRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzSW4iLCJzdXBwcmVzc0hpZ2hsaWdodGluZyIsInNldFN0YXRlIiwidG91Y2hhYmxlSGFuZGxlQWN0aXZlUHJlc3NPdXQiLCJ0b3VjaGFibGVIYW5kbGVQcmVzcyIsInRvdWNoYWJsZUhhbmRsZUxvbmdQcmVzcyIsIm9uTG9uZ1ByZXNzIiwicHJlc3NSZXRlbnRpb25PZmZzZXQiLCJuZXh0UHJvcHMiLCJwcmV2U3RhdGUiLCJDb21wb25lbnQiLCJkZWZhdWx0UHJvcHMiLCJhY2Nlc3NpYmxlIiwiUkNUVGV4dCIsIlJDVFZpcnR1YWxUZXh0IiwiZ2V0Vmlld01hbmFnZXJDb25maWciLCJUZXh0IiwiVGV4dFRvRXhwb3J0IiwiZm9yd2FyZFJlZiIsImRpc3BsYXlOYW1lIiwicHJvcFR5cGVzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBVUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLElBQU1BLHVCQUF1QixHQUFHQyxPQUFPLENBQUMsZ0RBQUQsQ0FBdkM7O0FBQ0EsSUFB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QUFBQSxTQUNsQkEsS0FBSyxDQUFDSSxPQUFOLElBQWlCLElBQWpCLElBQ0FKLEtBQUssQ0FBQ2lDLFdBQU4sSUFBcUIsSUFEckIsSUFFQWpDLEtBQUssQ0FBQ1MseUJBQU4sSUFBbUMsSUFIakI7QUFBQSxDQUFwQjs7QUFLQSxJQUFNK0IsT0FBTyxHQUFHOUUsK0JBQStCLENBQzdDUSxVQUFVLENBQUNxQixlQURrQyxFQUU3QztBQUFBLFNBQU1yQixVQUFOO0FBQUEsQ0FGNkMsQ0FBL0M7QUFLQSxJQUFNdUUsY0FBYyxHQUNsQmhGLFNBQVMsQ0FBQ2lGLG9CQUFWLENBQStCLGdCQUEvQixLQUFvRCxJQUFwRCxHQUNJRixPQURKLEdBRUk5RSwrQkFBK0IsQ0FBQyxnQkFBRCxFQUFtQjtBQUFBLFNBQU87QUFDdkRTLElBQUFBLGVBQWUsb0JBQ1ZiLHlCQUF5QixDQUFDYyxNQURoQjtBQUViQyxNQUFBQSxhQUFhLEVBQUUsSUFGRjtBQUdiSSxNQUFBQSxxQkFBcUIsRUFBRTtBQUhWLE1BRHdDO0FBTXZEYyxJQUFBQSxlQUFlLEVBQUU7QUFOc0MsR0FBUDtBQUFBLENBQW5CLENBSHJDOztBQVlBLElBQU1vRCxJQUFJLEdBQUcsU0FBUEEsSUFBTyxDQUNYM0MsS0FEVyxFQUVYUSxZQUZXLEVBR1I7QUFDSCxTQUFPLG9CQUFDLGFBQUQsNkJBQW1CUixLQUFuQjtBQUEwQixJQUFBLFlBQVksRUFBRVE7QUFBeEMsS0FBUDtBQUNELENBTEQ7O0FBTUEsSUFBTW9DLFlBQVksR0FBR3ZGLEtBQUssQ0FBQ3dGLFVBQU4sQ0FBaUJGLElBQWpCLENBQXJCO0FBQ0FDLFlBQVksQ0FBQ0UsV0FBYixHQUEyQixNQUEzQjtBQU1BRixZQUFZLENBQUNHLFNBQWIsR0FBeUI1Rix1QkFBekI7QUFFQTZGLE1BQU0sQ0FBQ0MsT0FBUCxHQUFtQkwsWUFBbkIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBEZXByZWNhdGVkVGV4dFByb3BUeXBlcyA9IHJlcXVpcmUoJy4uL0RlcHJlY2F0ZWRQcm9wVHlwZXMvRGVwcmVjYXRlZFRleHRQcm9wVHlwZXMnKTtcbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcbmNvbnN0IFJlYWN0TmF0aXZlVmlld0F0dHJpYnV0ZXMgPSByZXF1aXJlKCcuLi9Db21wb25lbnRzL1ZpZXcvUmVhY3ROYXRpdmVWaWV3QXR0cmlidXRlcycpO1xuY29uc3QgVGV4dEFuY2VzdG9yID0gcmVxdWlyZSgnLi9UZXh0QW5jZXN0b3InKTtcbmNvbnN0IFRvdWNoYWJsZSA9IHJlcXVpcmUoJy4uL0NvbXBvbmVudHMvVG91Y2hhYmxlL1RvdWNoYWJsZScpO1xuY29uc3QgVUlNYW5hZ2VyID0gcmVxdWlyZSgnLi4vUmVhY3ROYXRpdmUvVUlNYW5hZ2VyJyk7XG5cbmNvbnN0IGNyZWF0ZVJlYWN0TmF0aXZlQ29tcG9uZW50Q2xhc3MgPSByZXF1aXJlKCcuLi9SZW5kZXJlci9zaGltcy9jcmVhdGVSZWFjdE5hdGl2ZUNvbXBvbmVudENsYXNzJyk7XG5jb25zdCBudWxsdGhyb3dzID0gcmVxdWlyZSgnbnVsbHRocm93cycpO1xuY29uc3QgcHJvY2Vzc0NvbG9yID0gcmVxdWlyZSgnLi4vU3R5bGVTaGVldC9wcm9jZXNzQ29sb3InKTtcblxuaW1wb3J0IHR5cGUge1ByZXNzRXZlbnR9IGZyb20gJy4uL1R5cGVzL0NvcmVFdmVudFR5cGVzJztcbmltcG9ydCB0eXBlIHtOYXRpdmVDb21wb25lbnR9IGZyb20gJy4uL1JlbmRlcmVyL3NoaW1zL1JlYWN0TmF0aXZlJztcbmltcG9ydCB0eXBlIHtQcmVzc1JldGVudGlvbk9mZnNldCwgVGV4dFByb3BzfSBmcm9tICcuL1RleHRQcm9wcyc7XG5cbnR5cGUgUmVzcG9uc2VIYW5kbGVycyA9ICRSZWFkT25seTx7fFxuICBvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyOiAoKSA9PiBib29sZWFuLFxuICBvblJlc3BvbmRlckdyYW50OiAoZXZlbnQ6IFByZXNzRXZlbnQsIGRpc3BhdGNoSUQ6IHN0cmluZykgPT4gdm9pZCxcbiAgb25SZXNwb25kZXJNb3ZlOiAoZXZlbnQ6IFByZXNzRXZlbnQpID0+IHZvaWQsXG4gIG9uUmVzcG9uZGVyUmVsZWFzZTogKGV2ZW50OiBQcmVzc0V2ZW50KSA9PiB2b2lkLFxuICBvblJlc3BvbmRlclRlcm1pbmF0ZTogKGV2ZW50OiBQcmVzc0V2ZW50KSA9PiB2b2lkLFxuICBvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdDogKCkgPT4gYm9vbGVhbixcbnx9PjtcblxudHlwZSBQcm9wcyA9ICRSZWFkT25seTx7fFxuICAuLi5UZXh0UHJvcHMsXG4gIGZvcndhcmRlZFJlZjogP1JlYWN0LlJlZjwnUkNUVGV4dCcgfCAnUkNUVmlydHVhbFRleHQnPixcbnx9PjtcblxudHlwZSBTdGF0ZSA9IHt8XG4gIHRvdWNoYWJsZToge3xcbiAgICB0b3VjaFN0YXRlOiA/c3RyaW5nLFxuICAgIHJlc3BvbmRlcklEOiA/bnVtYmVyLFxuICB8fSxcbiAgaXNIaWdobGlnaHRlZDogYm9vbGVhbixcbiAgY3JlYXRlUmVzcG9uZGVySGFuZGxlcnM6ICgpID0+IFJlc3BvbnNlSGFuZGxlcnMsXG4gIHJlc3BvbnNlSGFuZGxlcnM6ID9SZXNwb25zZUhhbmRsZXJzLFxufH07XG5cbmNvbnN0IFBSRVNTX1JFQ1RfT0ZGU0VUID0ge3RvcDogMjAsIGxlZnQ6IDIwLCByaWdodDogMjAsIGJvdHRvbTogMzB9O1xuXG5jb25zdCB2aWV3Q29uZmlnID0ge1xuICB2YWxpZEF0dHJpYnV0ZXM6IHtcbiAgICAuLi5SZWFjdE5hdGl2ZVZpZXdBdHRyaWJ1dGVzLlVJVmlldyxcbiAgICBpc0hpZ2hsaWdodGVkOiB0cnVlLFxuICAgIG51bWJlck9mTGluZXM6IHRydWUsXG4gICAgZWxsaXBzaXplTW9kZTogdHJ1ZSxcbiAgICBhbGxvd0ZvbnRTY2FsaW5nOiB0cnVlLFxuICAgIG1heEZvbnRTaXplTXVsdGlwbGllcjogdHJ1ZSxcbiAgICBkaXNhYmxlZDogdHJ1ZSxcbiAgICBzZWxlY3RhYmxlOiB0cnVlLFxuICAgIHNlbGVjdGlvbkNvbG9yOiB0cnVlLFxuICAgIGFkanVzdHNGb250U2l6ZVRvRml0OiB0cnVlLFxuICAgIG1pbmltdW1Gb250U2NhbGU6IHRydWUsXG4gICAgdGV4dEJyZWFrU3RyYXRlZ3k6IHRydWUsXG4gICAgb25UZXh0TGF5b3V0OiB0cnVlLFxuICAgIG9uSW5saW5lVmlld0xheW91dDogdHJ1ZSxcbiAgICBkYXRhRGV0ZWN0b3JUeXBlOiB0cnVlLFxuICB9LFxuICBkaXJlY3RFdmVudFR5cGVzOiB7XG4gICAgdG9wVGV4dExheW91dDoge1xuICAgICAgcmVnaXN0cmF0aW9uTmFtZTogJ29uVGV4dExheW91dCcsXG4gICAgfSxcbiAgICB0b3BJbmxpbmVWaWV3TGF5b3V0OiB7XG4gICAgICByZWdpc3RyYXRpb25OYW1lOiAnb25JbmxpbmVWaWV3TGF5b3V0JyxcbiAgICB9LFxuICB9LFxuICB1aVZpZXdDbGFzc05hbWU6ICdSQ1RUZXh0Jyxcbn07XG5cbi8qKlxuICogQSBSZWFjdCBjb21wb25lbnQgZm9yIGRpc3BsYXlpbmcgdGV4dC5cbiAqXG4gKiBTZWUgaHR0cHM6Ly9mYWNlYm9vay5naXRodWIuaW8vcmVhY3QtbmF0aXZlL2RvY3MvdGV4dC5odG1sXG4gKi9cbmNsYXNzIFRvdWNoYWJsZVRleHQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgYWNjZXNzaWJsZTogdHJ1ZSxcbiAgICBhbGxvd0ZvbnRTY2FsaW5nOiB0cnVlLFxuICAgIGVsbGlwc2l6ZU1vZGU6ICd0YWlsJyxcbiAgfTtcblxuICB0b3VjaGFibGVHZXRQcmVzc1JlY3RPZmZzZXQ6ID8oKSA9PiBQcmVzc1JldGVudGlvbk9mZnNldDtcbiAgdG91Y2hhYmxlSGFuZGxlQWN0aXZlUHJlc3NJbjogPygpID0+IHZvaWQ7XG4gIHRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzT3V0OiA/KCkgPT4gdm9pZDtcbiAgdG91Y2hhYmxlSGFuZGxlTG9uZ1ByZXNzOiA/KGV2ZW50OiBQcmVzc0V2ZW50KSA9PiB2b2lkO1xuICB0b3VjaGFibGVIYW5kbGVQcmVzczogPyhldmVudDogUHJlc3NFdmVudCkgPT4gdm9pZDtcbiAgdG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyR3JhbnQ6ID8oXG4gICAgZXZlbnQ6IFByZXNzRXZlbnQsXG4gICAgZGlzcGF0Y2hJRDogc3RyaW5nLFxuICApID0+IHZvaWQ7XG4gIHRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlck1vdmU6ID8oZXZlbnQ6IFByZXNzRXZlbnQpID0+IHZvaWQ7XG4gIHRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclJlbGVhc2U6ID8oZXZlbnQ6IFByZXNzRXZlbnQpID0+IHZvaWQ7XG4gIHRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0ZTogPyhldmVudDogUHJlc3NFdmVudCkgPT4gdm9pZDtcbiAgdG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0OiA/KCkgPT4gYm9vbGVhbjtcblxuICBzdGF0ZSA9IHtcbiAgICAuLi5Ub3VjaGFibGUuTWl4aW4udG91Y2hhYmxlR2V0SW5pdGlhbFN0YXRlKCksXG4gICAgaXNIaWdobGlnaHRlZDogZmFsc2UsXG4gICAgY3JlYXRlUmVzcG9uZGVySGFuZGxlcnM6IHRoaXMuX2NyZWF0ZVJlc3BvbnNlSGFuZGxlcnMuYmluZCh0aGlzKSxcbiAgICByZXNwb25zZUhhbmRsZXJzOiBudWxsLFxuICB9O1xuXG4gIHN0YXRpYyBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMoXG4gICAgbmV4dFByb3BzOiBQcm9wcyxcbiAgICBwcmV2U3RhdGU6IFN0YXRlLFxuICApOiAkU2hhcGU8U3RhdGU+IHwgbnVsbCB7XG4gICAgcmV0dXJuIHByZXZTdGF0ZS5yZXNwb25zZUhhbmRsZXJzID09IG51bGwgJiYgaXNUb3VjaGFibGUobmV4dFByb3BzKVxuICAgICAgPyB7XG4gICAgICAgICAgcmVzcG9uc2VIYW5kbGVyczogcHJldlN0YXRlLmNyZWF0ZVJlc3BvbmRlckhhbmRsZXJzKCksXG4gICAgICAgIH1cbiAgICAgIDogbnVsbDtcbiAgfVxuXG4gIHN0YXRpYyB2aWV3Q29uZmlnID0gdmlld0NvbmZpZztcblxuICByZW5kZXIoKTogUmVhY3QuTm9kZSB7XG4gICAgbGV0IHByb3BzID0gdGhpcy5wcm9wcztcbiAgICBpZiAoaXNUb3VjaGFibGUocHJvcHMpKSB7XG4gICAgICBwcm9wcyA9IHtcbiAgICAgICAgLi4ucHJvcHMsXG4gICAgICAgIC4uLnRoaXMuc3RhdGUucmVzcG9uc2VIYW5kbGVycyxcbiAgICAgICAgaXNIaWdobGlnaHRlZDogdGhpcy5zdGF0ZS5pc0hpZ2hsaWdodGVkLFxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHByb3BzLnNlbGVjdGlvbkNvbG9yICE9IG51bGwpIHtcbiAgICAgIHByb3BzID0ge1xuICAgICAgICAuLi5wcm9wcyxcbiAgICAgICAgc2VsZWN0aW9uQ29sb3I6IHByb2Nlc3NDb2xvcihwcm9wcy5zZWxlY3Rpb25Db2xvciksXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAoX19ERVZfXykge1xuICAgICAgaWYgKFRvdWNoYWJsZS5UT1VDSF9UQVJHRVRfREVCVUcgJiYgcHJvcHMub25QcmVzcyAhPSBudWxsKSB7XG4gICAgICAgIHByb3BzID0ge1xuICAgICAgICAgIC4uLnByb3BzLFxuICAgICAgICAgIHN0eWxlOiBbcHJvcHMuc3R5bGUsIHtjb2xvcjogJ21hZ2VudGEnfV0sXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAoXG4gICAgICA8VGV4dEFuY2VzdG9yLkNvbnN1bWVyPlxuICAgICAgICB7aGFzVGV4dEFuY2VzdG9yID0+XG4gICAgICAgICAgaGFzVGV4dEFuY2VzdG9yID8gKFxuICAgICAgICAgICAgPFJDVFZpcnR1YWxUZXh0IHsuLi5wcm9wc30gcmVmPXtwcm9wcy5mb3J3YXJkZWRSZWZ9IC8+XG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxUZXh0QW5jZXN0b3IuUHJvdmlkZXIgdmFsdWU9e3RydWV9PlxuICAgICAgICAgICAgICA8UkNUVGV4dCB7Li4ucHJvcHN9IHJlZj17cHJvcHMuZm9yd2FyZGVkUmVmfSAvPlxuICAgICAgICAgICAgPC9UZXh0QW5jZXN0b3IuUHJvdmlkZXI+XG4gICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICA8L1RleHRBbmNlc3Rvci5Db25zdW1lcj5cbiAgICApO1xuICB9XG5cbiAgX2NyZWF0ZVJlc3BvbnNlSGFuZGxlcnMoKTogUmVzcG9uc2VIYW5kbGVycyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXI6ICgpOiBib29sZWFuID0+IHtcbiAgICAgICAgY29uc3Qge29uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJ9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qgc2hvdWxkU2V0UmVzcG9uZGVyID1cbiAgICAgICAgICAob25TdGFydFNob3VsZFNldFJlc3BvbmRlciA9PSBudWxsXG4gICAgICAgICAgICA/IGZhbHNlXG4gICAgICAgICAgICA6IG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXIoKSkgfHwgaXNUb3VjaGFibGUodGhpcy5wcm9wcyk7XG5cbiAgICAgICAgaWYgKHNob3VsZFNldFJlc3BvbmRlcikge1xuICAgICAgICAgIHRoaXMuX2F0dGFjaFRvdWNoSGFuZGxlcnMoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hvdWxkU2V0UmVzcG9uZGVyO1xuICAgICAgfSxcbiAgICAgIG9uUmVzcG9uZGVyR3JhbnQ6IChldmVudDogUHJlc3NFdmVudCwgZGlzcGF0Y2hJRDogc3RyaW5nKTogdm9pZCA9PiB7XG4gICAgICAgIG51bGx0aHJvd3ModGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJHcmFudCkoZXZlbnQsIGRpc3BhdGNoSUQpO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5vblJlc3BvbmRlckdyYW50ICE9IG51bGwpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLm9uUmVzcG9uZGVyR3JhbnQuY2FsbCh0aGlzLCBldmVudCwgZGlzcGF0Y2hJRCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvblJlc3BvbmRlck1vdmU6IChldmVudDogUHJlc3NFdmVudCk6IHZvaWQgPT4ge1xuICAgICAgICBudWxsdGhyb3dzKHRoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyTW92ZSkoZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5vblJlc3BvbmRlck1vdmUgIT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMucHJvcHMub25SZXNwb25kZXJNb3ZlLmNhbGwodGhpcywgZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb25SZXNwb25kZXJSZWxlYXNlOiAoZXZlbnQ6IFByZXNzRXZlbnQpOiB2b2lkID0+IHtcbiAgICAgICAgbnVsbHRocm93cyh0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclJlbGVhc2UpKGV2ZW50KTtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMub25SZXNwb25kZXJSZWxlYXNlICE9IG51bGwpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLm9uUmVzcG9uZGVyUmVsZWFzZS5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRlOiAoZXZlbnQ6IFByZXNzRXZlbnQpOiB2b2lkID0+IHtcbiAgICAgICAgbnVsbHRocm93cyh0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0ZSkoZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5vblJlc3BvbmRlclRlcm1pbmF0ZSAhPSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5vblJlc3BvbmRlclRlcm1pbmF0ZS5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0OiAoKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIGNvbnN0IHtvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBpZiAoIW51bGx0aHJvd3ModGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3QpKCkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0ID09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3QoKTtcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMYXppbHkgYXR0YWNoZXMgVG91Y2hhYmxlLk1peGluIGhhbmRsZXJzLlxuICAgKi9cbiAgX2F0dGFjaFRvdWNoSGFuZGxlcnMoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMudG91Y2hhYmxlR2V0UHJlc3NSZWN0T2Zmc2V0ICE9IG51bGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yIChjb25zdCBrZXkgaW4gVG91Y2hhYmxlLk1peGluKSB7XG4gICAgICBpZiAodHlwZW9mIFRvdWNoYWJsZS5NaXhpbltrZXldID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICh0aGlzOiBhbnkpW2tleV0gPSBUb3VjaGFibGUuTWl4aW5ba2V5XS5iaW5kKHRoaXMpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzSW4gPSAoKTogdm9pZCA9PiB7XG4gICAgICBpZiAoIXRoaXMucHJvcHMuc3VwcHJlc3NIaWdobGlnaHRpbmcgJiYgaXNUb3VjaGFibGUodGhpcy5wcm9wcykpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7aXNIaWdobGlnaHRlZDogdHJ1ZX0pO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy50b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc091dCA9ICgpOiB2b2lkID0+IHtcbiAgICAgIGlmICghdGhpcy5wcm9wcy5zdXBwcmVzc0hpZ2hsaWdodGluZyAmJiBpc1RvdWNoYWJsZSh0aGlzLnByb3BzKSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtpc0hpZ2hsaWdodGVkOiBmYWxzZX0pO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy50b3VjaGFibGVIYW5kbGVQcmVzcyA9IChldmVudDogUHJlc3NFdmVudCk6IHZvaWQgPT4ge1xuICAgICAgaWYgKHRoaXMucHJvcHMub25QcmVzcyAhPSBudWxsKSB7XG4gICAgICAgIHRoaXMucHJvcHMub25QcmVzcyhldmVudCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnRvdWNoYWJsZUhhbmRsZUxvbmdQcmVzcyA9IChldmVudDogUHJlc3NFdmVudCk6IHZvaWQgPT4ge1xuICAgICAgaWYgKHRoaXMucHJvcHMub25Mb25nUHJlc3MgIT0gbnVsbCkge1xuICAgICAgICB0aGlzLnByb3BzLm9uTG9uZ1ByZXNzKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMudG91Y2hhYmxlR2V0UHJlc3NSZWN0T2Zmc2V0ID0gKCk6IFByZXNzUmV0ZW50aW9uT2Zmc2V0ID0+XG4gICAgICB0aGlzLnByb3BzLnByZXNzUmV0ZW50aW9uT2Zmc2V0ID09IG51bGxcbiAgICAgICAgPyBQUkVTU19SRUNUX09GRlNFVFxuICAgICAgICA6IHRoaXMucHJvcHMucHJlc3NSZXRlbnRpb25PZmZzZXQ7XG4gIH1cbn1cblxuY29uc3QgaXNUb3VjaGFibGUgPSAocHJvcHM6IFByb3BzKTogYm9vbGVhbiA9PlxuICBwcm9wcy5vblByZXNzICE9IG51bGwgfHxcbiAgcHJvcHMub25Mb25nUHJlc3MgIT0gbnVsbCB8fFxuICBwcm9wcy5vblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyICE9IG51bGw7XG5cbmNvbnN0IFJDVFRleHQgPSBjcmVhdGVSZWFjdE5hdGl2ZUNvbXBvbmVudENsYXNzKFxuICB2aWV3Q29uZmlnLnVpVmlld0NsYXNzTmFtZSxcbiAgKCkgPT4gdmlld0NvbmZpZyxcbik7XG5cbmNvbnN0IFJDVFZpcnR1YWxUZXh0ID1cbiAgVUlNYW5hZ2VyLmdldFZpZXdNYW5hZ2VyQ29uZmlnKCdSQ1RWaXJ0dWFsVGV4dCcpID09IG51bGxcbiAgICA/IFJDVFRleHRcbiAgICA6IGNyZWF0ZVJlYWN0TmF0aXZlQ29tcG9uZW50Q2xhc3MoJ1JDVFZpcnR1YWxUZXh0JywgKCkgPT4gKHtcbiAgICAgICAgdmFsaWRBdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgLi4uUmVhY3ROYXRpdmVWaWV3QXR0cmlidXRlcy5VSVZpZXcsXG4gICAgICAgICAgaXNIaWdobGlnaHRlZDogdHJ1ZSxcbiAgICAgICAgICBtYXhGb250U2l6ZU11bHRpcGxpZXI6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHVpVmlld0NsYXNzTmFtZTogJ1JDVFZpcnR1YWxUZXh0JyxcbiAgICAgIH0pKTtcblxuY29uc3QgVGV4dCA9IChcbiAgcHJvcHM6IFRleHRQcm9wcyxcbiAgZm9yd2FyZGVkUmVmOiA/UmVhY3QuUmVmPCdSQ1RUZXh0JyB8ICdSQ1RWaXJ0dWFsVGV4dCc+LFxuKSA9PiB7XG4gIHJldHVybiA8VG91Y2hhYmxlVGV4dCB7Li4ucHJvcHN9IGZvcndhcmRlZFJlZj17Zm9yd2FyZGVkUmVmfSAvPjtcbn07XG5jb25zdCBUZXh0VG9FeHBvcnQgPSBSZWFjdC5mb3J3YXJkUmVmKFRleHQpO1xuVGV4dFRvRXhwb3J0LmRpc3BsYXlOYW1lID0gJ1RleHQnO1xuXG4vLyBUT0RPOiBEZXByZWNhdGUgdGhpcy5cbi8qICRGbG93Rml4TWUoPj0wLjg5LjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXMgY29tbWVudCBzdXBwcmVzc2VzIGFuIGVycm9yXG4gKiBmb3VuZCB3aGVuIEZsb3cgdjAuODkgd2FzIGRlcGxveWVkLiBUbyBzZWUgdGhlIGVycm9yLCBkZWxldGUgdGhpcyBjb21tZW50XG4gKiBhbmQgcnVuIEZsb3cuICovXG5UZXh0VG9FeHBvcnQucHJvcFR5cGVzID0gRGVwcmVjYXRlZFRleHRQcm9wVHlwZXM7XG5cbm1vZHVsZS5leHBvcnRzID0gKChUZXh0VG9FeHBvcnQ6ICRGbG93Rml4TWUpOiBDbGFzczxcbiAgTmF0aXZlQ29tcG9uZW50PFRleHRQcm9wcz4sXG4+KTtcbiJdfQ==