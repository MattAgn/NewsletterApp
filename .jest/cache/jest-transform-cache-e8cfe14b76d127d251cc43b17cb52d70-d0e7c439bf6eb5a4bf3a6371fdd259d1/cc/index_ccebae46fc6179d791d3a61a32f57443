4ee524315b4d2196a3c30220dbc4a624
"use strict";

function _(message, opts) {
  return (opts && opts.context ? opts.context : "Value") + " " + message + ".";
}

function type(V) {
  if (V === null) {
    return "Null";
  }

  switch (typeof V) {
    case "undefined":
      return "Undefined";

    case "boolean":
      return "Boolean";

    case "number":
      return "Number";

    case "string":
      return "String";

    case "symbol":
      return "Symbol";

    case "object":
    case "function":
    default:
      return "Object";
  }
}

function evenRound(x) {
  if (x > 0 && x % 1 === +0.5 && (x & 1) === 0 || x < 0 && x % 1 === -0.5 && (x & 1) === 1) {
    return censorNegativeZero(Math.floor(x));
  }

  return censorNegativeZero(Math.round(x));
}

function integerPart(n) {
  return censorNegativeZero(Math.trunc(n));
}

function sign(x) {
  return x < 0 ? -1 : 1;
}

function modulo(x, y) {
  var signMightNotMatch = x % y;

  if (sign(y) !== sign(signMightNotMatch)) {
    return signMightNotMatch + y;
  }

  return signMightNotMatch;
}

function censorNegativeZero(x) {
  return x === 0 ? 0 : x;
}

function createIntegerConversion(bitLength, typeOpts) {
  var isSigned = !typeOpts.unsigned;
  var lowerBound;
  var upperBound;

  if (bitLength === 64) {
    upperBound = Math.pow(2, 53) - 1;
    lowerBound = !isSigned ? 0 : -Math.pow(2, 53) + 1;
  } else if (!isSigned) {
    lowerBound = 0;
    upperBound = Math.pow(2, bitLength) - 1;
  } else {
    lowerBound = -Math.pow(2, bitLength - 1);
    upperBound = Math.pow(2, bitLength - 1) - 1;
  }

  var twoToTheBitLength = Math.pow(2, bitLength);
  var twoToOneLessThanTheBitLength = Math.pow(2, bitLength - 1);
  return function (V, opts) {
    if (opts === undefined) {
      opts = {};
    }

    var x = +V;
    x = censorNegativeZero(x);

    if (opts.enforceRange) {
      if (!Number.isFinite(x)) {
        throw new TypeError(_("is not a finite number", opts));
      }

      x = integerPart(x);

      if (x < lowerBound || x > upperBound) {
        throw new TypeError(_("is outside the accepted range of " + lowerBound + " to " + upperBound + ", inclusive", opts));
      }

      return x;
    }

    if (!Number.isNaN(x) && opts.clamp) {
      x = Math.min(Math.max(x, lowerBound), upperBound);
      x = evenRound(x);
      return x;
    }

    if (!Number.isFinite(x) || x === 0) {
      return 0;
    }

    x = integerPart(x);

    if (x >= lowerBound && x <= upperBound) {
      return x;
    }

    x = modulo(x, twoToTheBitLength);

    if (isSigned && x >= twoToOneLessThanTheBitLength) {
      return x - twoToTheBitLength;
    }

    return x;
  };
}

exports.any = function (V) {
  return V;
};

exports.void = function () {
  return undefined;
};

exports.boolean = function (val) {
  return !!val;
};

exports.byte = createIntegerConversion(8, {
  unsigned: false
});
exports.octet = createIntegerConversion(8, {
  unsigned: true
});
exports.short = createIntegerConversion(16, {
  unsigned: false
});
exports["unsigned short"] = createIntegerConversion(16, {
  unsigned: true
});
exports.long = createIntegerConversion(32, {
  unsigned: false
});
exports["unsigned long"] = createIntegerConversion(32, {
  unsigned: true
});
exports["long long"] = createIntegerConversion(64, {
  unsigned: false
});
exports["unsigned long long"] = createIntegerConversion(64, {
  unsigned: true
});

exports.double = function (V, opts) {
  var x = +V;

  if (!Number.isFinite(x)) {
    throw new TypeError(_("is not a finite floating-point value", opts));
  }

  return x;
};

exports["unrestricted double"] = function (V) {
  var x = +V;
  return x;
};

exports.float = function (V, opts) {
  var x = +V;

  if (!Number.isFinite(x)) {
    throw new TypeError(_("is not a finite floating-point value", opts));
  }

  if (Object.is(x, -0)) {
    return x;
  }

  var y = Math.fround(x);

  if (!Number.isFinite(y)) {
    throw new TypeError(_("is outside the range of a single-precision floating-point value", opts));
  }

  return y;
};

exports["unrestricted float"] = function (V) {
  var x = +V;

  if (isNaN(x)) {
    return x;
  }

  if (Object.is(x, -0)) {
    return x;
  }

  return Math.fround(x);
};

exports.DOMString = function (V, opts) {
  if (opts === undefined) {
    opts = {};
  }

  if (opts.treatNullAsEmptyString && V === null) {
    return "";
  }

  if (typeof V === "symbol") {
    throw new TypeError(_("is a symbol, which cannot be converted to a string", opts));
  }

  return String(V);
};

exports.ByteString = function (V, opts) {
  var x = exports.DOMString(V, opts);
  var c;

  for (var i = 0; (c = x.codePointAt(i)) !== undefined; ++i) {
    if (c > 255) {
      throw new TypeError(_("is not a valid ByteString", opts));
    }
  }

  return x;
};

exports.USVString = function (V, opts) {
  var S = exports.DOMString(V, opts);
  var n = S.length;
  var U = [];

  for (var i = 0; i < n; ++i) {
    var c = S.charCodeAt(i);

    if (c < 0xD800 || c > 0xDFFF) {
      U.push(String.fromCodePoint(c));
    } else if (0xDC00 <= c && c <= 0xDFFF) {
      U.push(String.fromCodePoint(0xFFFD));
    } else if (i === n - 1) {
      U.push(String.fromCodePoint(0xFFFD));
    } else {
      var d = S.charCodeAt(i + 1);

      if (0xDC00 <= d && d <= 0xDFFF) {
        var a = c & 0x3FF;
        var b = d & 0x3FF;
        U.push(String.fromCodePoint((2 << 15) + (2 << 9) * a + b));
        ++i;
      } else {
        U.push(String.fromCodePoint(0xFFFD));
      }
    }
  }

  return U.join("");
};

exports.object = function (V, opts) {
  if (type(V) !== "Object") {
    throw new TypeError(_("is not an object", opts));
  }

  return V;
};

function convertCallbackFunction(V, opts) {
  if (typeof V !== "function") {
    throw new TypeError(_("is not a function", opts));
  }

  return V;
}

[Error, ArrayBuffer, DataView, Int8Array, Int16Array, Int32Array, Uint8Array, Uint16Array, Uint32Array, Uint8ClampedArray, Float32Array, Float64Array].forEach(function (func) {
  var name = func.name;
  var article = /^[AEIOU]/.test(name) ? "an" : "a";

  exports[name] = function (V, opts) {
    if (!(V instanceof func)) {
      throw new TypeError(_("is not " + article + " " + name + " object", opts));
    }

    return V;
  };
});

exports.ArrayBufferView = function (V, opts) {
  if (!ArrayBuffer.isView(V)) {
    throw new TypeError(_("is not a view on an ArrayBuffer object", opts));
  }

  return V;
};

exports.BufferSource = function (V, opts) {
  if (!(ArrayBuffer.isView(V) || V instanceof ArrayBuffer)) {
    throw new TypeError(_("is not an ArrayBuffer object or a view on one", opts));
  }

  return V;
};

exports.DOMTimeStamp = exports["unsigned long long"];
exports.Function = convertCallbackFunction;
exports.VoidFunction = convertCallbackFunction;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIl8iLCJtZXNzYWdlIiwib3B0cyIsImNvbnRleHQiLCJ0eXBlIiwiViIsImV2ZW5Sb3VuZCIsIngiLCJjZW5zb3JOZWdhdGl2ZVplcm8iLCJNYXRoIiwiZmxvb3IiLCJyb3VuZCIsImludGVnZXJQYXJ0IiwibiIsInRydW5jIiwic2lnbiIsIm1vZHVsbyIsInkiLCJzaWduTWlnaHROb3RNYXRjaCIsImNyZWF0ZUludGVnZXJDb252ZXJzaW9uIiwiYml0TGVuZ3RoIiwidHlwZU9wdHMiLCJpc1NpZ25lZCIsInVuc2lnbmVkIiwibG93ZXJCb3VuZCIsInVwcGVyQm91bmQiLCJwb3ciLCJ0d29Ub1RoZUJpdExlbmd0aCIsInR3b1RvT25lTGVzc1RoYW5UaGVCaXRMZW5ndGgiLCJ1bmRlZmluZWQiLCJlbmZvcmNlUmFuZ2UiLCJOdW1iZXIiLCJpc0Zpbml0ZSIsIlR5cGVFcnJvciIsImlzTmFOIiwiY2xhbXAiLCJtaW4iLCJtYXgiLCJleHBvcnRzIiwiYW55Iiwidm9pZCIsImJvb2xlYW4iLCJ2YWwiLCJieXRlIiwib2N0ZXQiLCJzaG9ydCIsImxvbmciLCJkb3VibGUiLCJmbG9hdCIsIk9iamVjdCIsImlzIiwiZnJvdW5kIiwiRE9NU3RyaW5nIiwidHJlYXROdWxsQXNFbXB0eVN0cmluZyIsIlN0cmluZyIsIkJ5dGVTdHJpbmciLCJjIiwiaSIsImNvZGVQb2ludEF0IiwiVVNWU3RyaW5nIiwiUyIsImxlbmd0aCIsIlUiLCJjaGFyQ29kZUF0IiwicHVzaCIsImZyb21Db2RlUG9pbnQiLCJkIiwiYSIsImIiLCJqb2luIiwib2JqZWN0IiwiY29udmVydENhbGxiYWNrRnVuY3Rpb24iLCJFcnJvciIsIkFycmF5QnVmZmVyIiwiRGF0YVZpZXciLCJJbnQ4QXJyYXkiLCJJbnQxNkFycmF5IiwiSW50MzJBcnJheSIsIlVpbnQ4QXJyYXkiLCJVaW50MTZBcnJheSIsIlVpbnQzMkFycmF5IiwiVWludDhDbGFtcGVkQXJyYXkiLCJGbG9hdDMyQXJyYXkiLCJGbG9hdDY0QXJyYXkiLCJmb3JFYWNoIiwiZnVuYyIsIm5hbWUiLCJhcnRpY2xlIiwidGVzdCIsIkFycmF5QnVmZmVyVmlldyIsImlzVmlldyIsIkJ1ZmZlclNvdXJjZSIsIkRPTVRpbWVTdGFtcCIsIkZ1bmN0aW9uIiwiVm9pZEZ1bmN0aW9uIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxTQUFTQSxDQUFULENBQVdDLE9BQVgsRUFBb0JDLElBQXBCLEVBQTBCO0FBQ3RCLFVBQVVBLElBQUksSUFBSUEsSUFBSSxDQUFDQyxPQUFiLEdBQXVCRCxJQUFJLENBQUNDLE9BQTVCLEdBQXNDLE9BQWhELFVBQTJERixPQUEzRDtBQUNIOztBQUVELFNBQVNHLElBQVQsQ0FBY0MsQ0FBZCxFQUFpQjtBQUNiLE1BQUlBLENBQUMsS0FBSyxJQUFWLEVBQWdCO0FBQ1osV0FBTyxNQUFQO0FBQ0g7O0FBQ0QsVUFBUSxPQUFPQSxDQUFmO0FBQ0ksU0FBSyxXQUFMO0FBQ0ksYUFBTyxXQUFQOztBQUNKLFNBQUssU0FBTDtBQUNJLGFBQU8sU0FBUDs7QUFDSixTQUFLLFFBQUw7QUFDSSxhQUFPLFFBQVA7O0FBQ0osU0FBSyxRQUFMO0FBQ0ksYUFBTyxRQUFQOztBQUNKLFNBQUssUUFBTDtBQUNJLGFBQU8sUUFBUDs7QUFDSixTQUFLLFFBQUw7QUFFQSxTQUFLLFVBQUw7QUFFQTtBQUlJLGFBQU8sUUFBUDtBQW5CUjtBQXFCSDs7QUFHRCxTQUFTQyxTQUFULENBQW1CQyxDQUFuQixFQUFzQjtBQVdsQixNQUFLQSxDQUFDLEdBQUcsQ0FBSixJQUFVQSxDQUFDLEdBQUcsQ0FBTCxLQUFZLENBQUMsR0FBdEIsSUFBNkIsQ0FBQ0EsQ0FBQyxHQUFHLENBQUwsTUFBWSxDQUExQyxJQUNDQSxDQUFDLEdBQUcsQ0FBSixJQUFVQSxDQUFDLEdBQUcsQ0FBTCxLQUFZLENBQUMsR0FBdEIsSUFBNkIsQ0FBQ0EsQ0FBQyxHQUFHLENBQUwsTUFBWSxDQUQ5QyxFQUNrRDtBQUM5QyxXQUFPQyxrQkFBa0IsQ0FBQ0MsSUFB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SUFBSXhDLFNBQUosQ0FBY2pDLENBQUMsQ0FBQywrQ0FBRCxFQUFrREUsSUFBbEQsQ0FBZixDQUFOO0FBQ0g7O0FBRUQsU0FBT0csQ0FBUDtBQUNILENBTkQ7O0FBUUFpQyxPQUFPLENBQUNzRCxZQUFSLEdBQXVCdEQsT0FBTyxDQUFDLG9CQUFELENBQTlCO0FBRUFBLE9BQU8sQ0FBQ3VELFFBQVIsR0FBbUJ0Qix1QkFBbkI7QUFFQWpDLE9BQU8sQ0FBQ3dELFlBQVIsR0FBdUJ2Qix1QkFBdkIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gXyhtZXNzYWdlLCBvcHRzKSB7XG4gICAgcmV0dXJuIGAke29wdHMgJiYgb3B0cy5jb250ZXh0ID8gb3B0cy5jb250ZXh0IDogXCJWYWx1ZVwifSAke21lc3NhZ2V9LmA7XG59XG5cbmZ1bmN0aW9uIHR5cGUoVikge1xuICAgIGlmIChWID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBcIk51bGxcIjtcbiAgICB9XG4gICAgc3dpdGNoICh0eXBlb2YgVikge1xuICAgICAgICBjYXNlIFwidW5kZWZpbmVkXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJVbmRlZmluZWRcIjtcbiAgICAgICAgY2FzZSBcImJvb2xlYW5cIjpcbiAgICAgICAgICAgIHJldHVybiBcIkJvb2xlYW5cIjtcbiAgICAgICAgY2FzZSBcIm51bWJlclwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiTnVtYmVyXCI7XG4gICAgICAgIGNhc2UgXCJzdHJpbmdcIjpcbiAgICAgICAgICAgIHJldHVybiBcIlN0cmluZ1wiO1xuICAgICAgICBjYXNlIFwic3ltYm9sXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJTeW1ib2xcIjtcbiAgICAgICAgY2FzZSBcIm9iamVjdFwiOlxuICAgICAgICAgICAgLy8gRmFsbHMgdGhyb3VnaFxuICAgICAgICBjYXNlIFwiZnVuY3Rpb25cIjpcbiAgICAgICAgICAgIC8vIEZhbGxzIHRocm91Z2hcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIC8vIFBlciBFUyBzcGVjLCB0eXBlb2YgcmV0dXJucyBhbiBpbXBsZW1lbnRpb24tZGVmaW5lZCB2YWx1ZSB0aGF0IGlzIG5vdCBhbnkgb2YgdGhlIGV4aXN0aW5nIG9uZXMgZm9yXG4gICAgICAgICAgICAvLyB1bmNhbGxhYmxlIG5vbi1zdGFuZGFyZCBleG90aWMgb2JqZWN0cy4gWWV0IFR5cGUoKSB3aGljaCB0aGUgV2ViIElETCBzcGVjIGRlcGVuZHMgb24gcmV0dXJucyBPYmplY3QgZm9yXG4gICAgICAgICAgICAvLyBzdWNoIGNhc2VzLiBTbyB0cmVhdCB0aGUgZGVmYXVsdCBjYXNlIGFzIGFuIG9iamVjdC5cbiAgICAgICAgICAgIHJldHVybiBcIk9iamVjdFwiO1xuICAgIH1cbn1cblxuLy8gUm91bmQgeCB0byB0aGUgbmVhcmVzdCBpbnRlZ2VyLCBjaG9vc2luZyB0aGUgZXZlbiBpbnRlZ2VyIGlmIGl0IGxpZXMgaGFsZndheSBiZXR3ZWVuIHR3by5cbmZ1bmN0aW9uIGV2ZW5Sb3VuZCh4KSB7XG4gICAgLy8gVGhlcmUgYXJlIGZvdXIgY2FzZXMgZm9yIG51bWJlcnMgd2l0aCBmcmFjdGlvbmFsIHBhcnQgYmVpbmcgLjU6XG4gICAgLy9cbiAgICAvLyBjYXNlIHwgICAgIHggICAgIHwgZmxvb3IoeCkgfCByb3VuZCh4KSB8IGV4cGVjdGVkIHwgeCA8PiAwIHwgeCAlIDEgfCB4ICYgMSB8ICAgZXhhbXBsZVxuICAgIC8vICAgMSAgfCAgMm4gKyAwLjUgfCAgMm4gICAgICB8ICAybiArIDEgIHwgIDJuICAgICAgfCAgID4gICAgfCAgMC41ICB8ICAgMCAgIHwgIDAuNSAtPiAgMFxuICAgIC8vICAgMiAgfCAgMm4gKyAxLjUgfCAgMm4gKyAxICB8ICAybiArIDIgIHwgIDJuICsgMiAgfCAgID4gICAgfCAgMC41ICB8ICAgMSAgIHwgIDEuNSAtPiAgMlxuICAgIC8vICAgMyAgfCAtMm4gLSAwLjUgfCAtMm4gLSAxICB8IC0ybiAgICAgIHwgLTJuICAgICAgfCAgIDwgICAgfCAtMC41ICB8ICAgMCAgIHwgLTAuNSAtPiAgMFxuICAgIC8vICAgNCAgfCAtMm4gLSAxLjUgfCAtMm4gLSAyICB8IC0ybiAtIDEgIHwgLTJuIC0gMiAgfCAgIDwgICAgfCAtMC41ICB8ICAgMSAgIHwgLTEuNSAtPiAtMlxuICAgIC8vICh3aGVyZSBuIGlzIGEgbm9uLW5lZ2F0aXZlIGludGVnZXIpXG4gICAgLy9cbiAgICAvLyBCcmFuY2ggaGVyZSBmb3IgY2FzZXMgMSBhbmQgNFxuICAgIGlmICgoeCA+IDAgJiYgKHggJSAxKSA9PT0gKzAuNSAmJiAoeCAmIDEpID09PSAwKSB8fFxuICAgICAgICAoeCA8IDAgJiYgKHggJSAxKSA9PT0gLTAuNSAmJiAoeCAmIDEpID09PSAxKSkge1xuICAgICAgICByZXR1cm4gY2Vuc29yTmVnYXRpdmVaZXJvKE1hdGguZmxvb3IoeCkpO1xuICAgIH1cblxuICAgIHJldHVybiBjZW5zb3JOZWdhdGl2ZVplcm8oTWF0aC5yb3VuZCh4KSk7XG59XG5cbmZ1bmN0aW9uIGludGVnZXJQYXJ0KG4pIHtcbiAgICByZXR1cm4gY2Vuc29yTmVnYXRpdmVaZXJvKE1hdGgudHJ1bmMobikpO1xufVxuXG5mdW5jdGlvbiBzaWduKHgpIHtcbiAgICByZXR1cm4geCA8IDAgPyAtMSA6IDE7XG59XG5cbmZ1bmN0aW9uIG1vZHVsbyh4LCB5KSB7XG4gICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNlcW4tbW9kdWxvXG4gICAgLy8gTm90ZSB0aGF0IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzQ0Njc1NTkvMzE5MSBkb2VzIE5PVCB3b3JrIGZvciBsYXJnZSBtb2R1bG9zXG4gICAgY29uc3Qgc2lnbk1pZ2h0Tm90TWF0Y2ggPSB4ICUgeTtcbiAgICBpZiAoc2lnbih5KSAhPT0gc2lnbihzaWduTWlnaHROb3RNYXRjaCkpIHtcbiAgICAgICAgcmV0dXJuIHNpZ25NaWdodE5vdE1hdGNoICsgeTtcbiAgICB9XG4gICAgcmV0dXJuIHNpZ25NaWdodE5vdE1hdGNoO1xufVxuXG5mdW5jdGlvbiBjZW5zb3JOZWdhdGl2ZVplcm8oeCkge1xuICAgIHJldHVybiB4ID09PSAwID8gMCA6IHg7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUludGVnZXJDb252ZXJzaW9uKGJpdExlbmd0aCwgdHlwZU9wdHMpIHtcbiAgICBjb25zdCBpc1NpZ25lZCA9ICF0eXBlT3B0cy51bnNpZ25lZDtcblxuICAgIGxldCBsb3dlckJvdW5kO1xuICAgIGxldCB1cHBlckJvdW5kO1xuICAgIGlmIChiaXRMZW5ndGggPT09IDY0KSB7XG4gICAgICAgIHVwcGVyQm91bmQgPSBNYXRoLnBvdygyLCA1MykgLSAxO1xuICAgICAgICBsb3dlckJvdW5kID0gIWlzU2lnbmVkID8gMCA6IC1NYXRoLnBvdygyLCA1MykgKyAxO1xuICAgIH0gZWxzZSBpZiAoIWlzU2lnbmVkKSB7XG4gICAgICAgIGxvd2VyQm91bmQgPSAwO1xuICAgICAgICB1cHBlckJvdW5kID0gTWF0aC5wb3coMiwgYml0TGVuZ3RoKSAtIDE7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbG93ZXJCb3VuZCA9IC1NYXRoLnBvdygyLCBiaXRMZW5ndGggLSAxKTtcbiAgICAgICAgdXBwZXJCb3VuZCA9IE1hdGgucG93KDIsIGJpdExlbmd0aCAtIDEpIC0gMTtcbiAgICB9XG5cbiAgICBjb25zdCB0d29Ub1RoZUJpdExlbmd0aCA9IE1hdGgucG93KDIsIGJpdExlbmd0aCk7XG4gICAgY29uc3QgdHdvVG9PbmVMZXNzVGhhblRoZUJpdExlbmd0aCA9IE1hdGgucG93KDIsIGJpdExlbmd0aCAtIDEpO1xuXG4gICAgcmV0dXJuIChWLCBvcHRzKSA9PiB7XG4gICAgICAgIGlmIChvcHRzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9wdHMgPSB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB4ID0gK1Y7XG4gICAgICAgIHggPSBjZW5zb3JOZWdhdGl2ZVplcm8oeCk7IC8vIFNwZWMgZGlzY3Vzc2lvbiBvbmdvaW5nOiBodHRwczovL2dpdGh1Yi5jb20vaGV5Y2FtL3dlYmlkbC9pc3N1ZXMvMzA2XG5cbiAgICAgICAgaWYgKG9wdHMuZW5mb3JjZVJhbmdlKSB7XG4gICAgICAgICAgICBpZiAoIU51bWJlci5pc0Zpbml0ZSh4KSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXyhcImlzIG5vdCBhIGZpbml0ZSBudW1iZXJcIiwgb3B0cykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB4ID0gaW50ZWdlclBhcnQoeCk7XG5cbiAgICAgICAgICAgIGlmICh4IDwgbG93ZXJCb3VuZCB8fCB4ID4gdXBwZXJCb3VuZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXyhcbiAgICAgICAgICAgICAgICAgICAgYGlzIG91dHNpZGUgdGhlIGFjY2VwdGVkIHJhbmdlIG9mICR7bG93ZXJCb3VuZH0gdG8gJHt1cHBlckJvdW5kfSwgaW5jbHVzaXZlYCwgb3B0cykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4geDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghTnVtYmVyLmlzTmFOKHgpICYmIG9wdHMuY2xhbXApIHtcbiAgICAgICAgICAgIHggPSBNYXRoLm1pbihNYXRoLm1heCh4LCBsb3dlckJvdW5kKSwgdXBwZXJCb3VuZCk7XG4gICAgICAgICAgICB4ID0gZXZlblJvdW5kKHgpO1xuICAgICAgICAgICAgcmV0dXJuIHg7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIU51bWJlci5pc0Zpbml0ZSh4KSB8fCB4ID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICB4ID0gaW50ZWdlclBhcnQoeCk7XG5cbiAgICAgICAgLy8gTWF0aC5wb3coMiwgNjQpIGlzIG5vdCBhY2N1cmF0ZWx5IHJlcHJlc2VudGFibGUgaW4gSmF2YVNjcmlwdCwgc28gdHJ5IHRvIGF2b2lkIHRoZXNlIHBlci1zcGVjIG9wZXJhdGlvbnMgaWZcbiAgICAgICAgLy8gcG9zc2libGUuIEhvcGVmdWxseSBpdCdzIGFuIG9wdGltaXphdGlvbiBmb3IgdGhlIG5vbi02NC1iaXRMZW5ndGggY2FzZXMgdG9vLlxuICAgICAgICBpZiAoeCA+PSBsb3dlckJvdW5kICYmIHggPD0gdXBwZXJCb3VuZCkge1xuICAgICAgICAgICAgcmV0dXJuIHg7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUaGVzZSB3aWxsIG5vdCB3b3JrIGdyZWF0IGZvciBiaXRMZW5ndGggb2YgNjQsIGJ1dCBvaCB3ZWxsLiBTZWUgdGhlIFJFQURNRSBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAgICB4ID0gbW9kdWxvKHgsIHR3b1RvVGhlQml0TGVuZ3RoKTtcbiAgICAgICAgaWYgKGlzU2lnbmVkICYmIHggPj0gdHdvVG9PbmVMZXNzVGhhblRoZUJpdExlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHggLSB0d29Ub1RoZUJpdExlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geDtcbiAgICB9O1xufVxuXG5leHBvcnRzLmFueSA9IFYgPT4ge1xuICAgIHJldHVybiBWO1xufTtcblxuZXhwb3J0cy52b2lkID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnRzLmJvb2xlYW4gPSBmdW5jdGlvbiAodmFsKSB7XG4gICAgcmV0dXJuICEhdmFsO1xufTtcblxuZXhwb3J0cy5ieXRlID0gY3JlYXRlSW50ZWdlckNvbnZlcnNpb24oOCwgeyB1bnNpZ25lZDogZmFsc2UgfSk7XG5leHBvcnRzLm9jdGV0ID0gY3JlYXRlSW50ZWdlckNvbnZlcnNpb24oOCwgeyB1bnNpZ25lZDogdHJ1ZSB9KTtcblxuZXhwb3J0cy5zaG9ydCA9IGNyZWF0ZUludGVnZXJDb252ZXJzaW9uKDE2LCB7IHVuc2lnbmVkOiBmYWxzZSB9KTtcbmV4cG9ydHNbXCJ1bnNpZ25lZCBzaG9ydFwiXSA9IGNyZWF0ZUludGVnZXJDb252ZXJzaW9uKDE2LCB7IHVuc2lnbmVkOiB0cnVlIH0pO1xuXG5leHBvcnRzLmxvbmcgPSBjcmVhdGVJbnRlZ2VyQ29udmVyc2lvbigzMiwgeyB1bnNpZ25lZDogZmFsc2UgfSk7XG5leHBvcnRzW1widW5zaWduZWQgbG9uZ1wiXSA9IGNyZWF0ZUludGVnZXJDb252ZXJzaW9uKDMyLCB7IHVuc2lnbmVkOiB0cnVlIH0pO1xuXG5leHBvcnRzW1wibG9uZyBsb25nXCJdID0gY3JlYXRlSW50ZWdlckNvbnZlcnNpb24oNjQsIHsgdW5zaWduZWQ6IGZhbHNlIH0pO1xuZXhwb3J0c1tcInVuc2lnbmVkIGxvbmcgbG9uZ1wiXSA9IGNyZWF0ZUludGVnZXJDb252ZXJzaW9uKDY0LCB7IHVuc2lnbmVkOiB0cnVlIH0pO1xuXG5leHBvcnRzLmRvdWJsZSA9IChWLCBvcHRzKSA9PiB7XG4gICAgY29uc3QgeCA9ICtWO1xuXG4gICAgaWYgKCFOdW1iZXIuaXNGaW5pdGUoeCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihfKFwiaXMgbm90IGEgZmluaXRlIGZsb2F0aW5nLXBvaW50IHZhbHVlXCIsIG9wdHMpKTtcbiAgICB9XG5cbiAgICByZXR1cm4geDtcbn07XG5cbmV4cG9ydHNbXCJ1bnJlc3RyaWN0ZWQgZG91YmxlXCJdID0gViA9PiB7XG4gICAgY29uc3QgeCA9ICtWO1xuXG4gICAgcmV0dXJuIHg7XG59O1xuXG5leHBvcnRzLmZsb2F0ID0gKFYsIG9wdHMpID0+IHtcbiAgICBjb25zdCB4ID0gK1Y7XG5cbiAgICBpZiAoIU51bWJlci5pc0Zpbml0ZSh4KSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKF8oXCJpcyBub3QgYSBmaW5pdGUgZmxvYXRpbmctcG9pbnQgdmFsdWVcIiwgb3B0cykpO1xuICAgIH1cblxuICAgIGlmIChPYmplY3QuaXMoeCwgLTApKSB7XG4gICAgICAgIHJldHVybiB4O1xuICAgIH1cblxuICAgIGNvbnN0IHkgPSBNYXRoLmZyb3VuZCh4KTtcblxuICAgIGlmICghTnVtYmVyLmlzRmluaXRlKHkpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXyhcImlzIG91dHNpZGUgdGhlIHJhbmdlIG9mIGEgc2luZ2xlLXByZWNpc2lvbiBmbG9hdGluZy1wb2ludCB2YWx1ZVwiLCBvcHRzKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHk7XG59O1xuXG5leHBvcnRzW1widW5yZXN0cmljdGVkIGZsb2F0XCJdID0gViA9PiB7XG4gICAgY29uc3QgeCA9ICtWO1xuXG4gICAgaWYgKGlzTmFOKHgpKSB7XG4gICAgICAgIHJldHVybiB4O1xuICAgIH1cblxuICAgIGlmIChPYmplY3QuaXMoeCwgLTApKSB7XG4gICAgICAgIHJldHVybiB4O1xuICAgIH1cblxuICAgIHJldHVybiBNYXRoLmZyb3VuZCh4KTtcbn07XG5cbmV4cG9ydHMuRE9NU3RyaW5nID0gZnVuY3Rpb24gKFYsIG9wdHMpIHtcbiAgICBpZiAob3B0cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG9wdHMgPSB7fTtcbiAgICB9XG5cbiAgICBpZiAob3B0cy50cmVhdE51bGxBc0VtcHR5U3RyaW5nICYmIFYgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBWID09PSBcInN5bWJvbFwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXyhcImlzIGEgc3ltYm9sLCB3aGljaCBjYW5ub3QgYmUgY29udmVydGVkIHRvIGEgc3RyaW5nXCIsIG9wdHMpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gU3RyaW5nKFYpO1xufTtcblxuZXhwb3J0cy5CeXRlU3RyaW5nID0gKFYsIG9wdHMpID0+IHtcbiAgICBjb25zdCB4ID0gZXhwb3J0cy5ET01TdHJpbmcoViwgb3B0cyk7XG4gICAgbGV0IGM7XG4gICAgZm9yIChsZXQgaSA9IDA7IChjID0geC5jb2RlUG9pbnRBdChpKSkgIT09IHVuZGVmaW5lZDsgKytpKSB7XG4gICAgICAgIGlmIChjID4gMjU1KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKF8oXCJpcyBub3QgYSB2YWxpZCBCeXRlU3RyaW5nXCIsIG9wdHMpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB4O1xufTtcblxuZXhwb3J0cy5VU1ZTdHJpbmcgPSAoViwgb3B0cykgPT4ge1xuICAgIGNvbnN0IFMgPSBleHBvcnRzLkRPTVN0cmluZyhWLCBvcHRzKTtcbiAgICBjb25zdCBuID0gUy5sZW5ndGg7XG4gICAgY29uc3QgVSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICAgIGNvbnN0IGMgPSBTLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIGlmIChjIDwgMHhEODAwIHx8IGMgPiAweERGRkYpIHtcbiAgICAgICAgICAgIFUucHVzaChTdHJpbmcuZnJvbUNvZGVQb2ludChjKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoMHhEQzAwIDw9IGMgJiYgYyA8PSAweERGRkYpIHtcbiAgICAgICAgICAgIFUucHVzaChTdHJpbmcuZnJvbUNvZGVQb2ludCgweEZGRkQpKTtcbiAgICAgICAgfSBlbHNlIGlmIChpID09PSBuIC0gMSkge1xuICAgICAgICAgICAgVS5wdXNoKFN0cmluZy5mcm9tQ29kZVBvaW50KDB4RkZGRCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZCA9IFMuY2hhckNvZGVBdChpICsgMSk7XG4gICAgICAgICAgICBpZiAoMHhEQzAwIDw9IGQgJiYgZCA8PSAweERGRkYpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gYyAmIDB4M0ZGO1xuICAgICAgICAgICAgICAgIGNvbnN0IGIgPSBkICYgMHgzRkY7XG4gICAgICAgICAgICAgICAgVS5wdXNoKFN0cmluZy5mcm9tQ29kZVBvaW50KCgyIDw8IDE1KSArICgoMiA8PCA5KSAqIGEpICsgYikpO1xuICAgICAgICAgICAgICAgICsraTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgVS5wdXNoKFN0cmluZy5mcm9tQ29kZVBvaW50KDB4RkZGRCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFUuam9pbihcIlwiKTtcbn07XG5cbmV4cG9ydHMub2JqZWN0ID0gKFYsIG9wdHMpID0+IHtcbiAgICBpZiAodHlwZShWKSAhPT0gXCJPYmplY3RcIikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKF8oXCJpcyBub3QgYW4gb2JqZWN0XCIsIG9wdHMpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gVjtcbn07XG5cbi8vIE5vdCBleHBvcnRlZCwgYnV0IHVzZWQgaW4gRnVuY3Rpb24gYW5kIFZvaWRGdW5jdGlvbi5cblxuLy8gTmVpdGhlciBGdW5jdGlvbiBub3IgVm9pZEZ1bmN0aW9uIGlzIGRlZmluZWQgd2l0aCBbVHJlYXROb25PYmplY3RBc051bGxdLCBzb1xuLy8gaGFuZGxpbmcgZm9yIHRoYXQgaXMgb21pdHRlZC5cbmZ1bmN0aW9uIGNvbnZlcnRDYWxsYmFja0Z1bmN0aW9uKFYsIG9wdHMpIHtcbiAgICBpZiAodHlwZW9mIFYgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKF8oXCJpcyBub3QgYSBmdW5jdGlvblwiLCBvcHRzKSk7XG4gICAgfVxuICAgIHJldHVybiBWO1xufVxuXG5bXG4gICAgRXJyb3IsXG4gICAgQXJyYXlCdWZmZXIsIC8vIFRoZSBJc0RldGFjaGVkQnVmZmVyIGFic3RyYWN0IG9wZXJhdGlvbiBpcyBub3QgZXhwb3NlZCBpbiBKU1xuICAgIERhdGFWaWV3LCBJbnQ4QXJyYXksIEludDE2QXJyYXksIEludDMyQXJyYXksIFVpbnQ4QXJyYXksXG4gICAgVWludDE2QXJyYXksIFVpbnQzMkFycmF5LCBVaW50OENsYW1wZWRBcnJheSwgRmxvYXQzMkFycmF5LCBGbG9hdDY0QXJyYXlcbl0uZm9yRWFjaChmdW5jID0+IHtcbiAgICBjb25zdCBuYW1lID0gZnVuYy5uYW1lO1xuICAgIGNvbnN0IGFydGljbGUgPSAvXltBRUlPVV0vLnRlc3QobmFtZSkgPyBcImFuXCIgOiBcImFcIjtcbiAgICBleHBvcnRzW25hbWVdID0gKFYsIG9wdHMpID0+IHtcbiAgICAgICAgaWYgKCEoViBpbnN0YW5jZW9mIGZ1bmMpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKF8oYGlzIG5vdCAke2FydGljbGV9ICR7bmFtZX0gb2JqZWN0YCwgb3B0cykpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFY7XG4gICAgfTtcbn0pO1xuXG4vLyBDb21tb24gZGVmaW5pdGlvbnNcblxuZXhwb3J0cy5BcnJheUJ1ZmZlclZpZXcgPSAoViwgb3B0cykgPT4ge1xuICAgIGlmICghQXJyYXlCdWZmZXIuaXNWaWV3KFYpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXyhcImlzIG5vdCBhIHZpZXcgb24gYW4gQXJyYXlCdWZmZXIgb2JqZWN0XCIsIG9wdHMpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gVjtcbn07XG5cbmV4cG9ydHMuQnVmZmVyU291cmNlID0gKFYsIG9wdHMpID0+IHtcbiAgICBpZiAoIShBcnJheUJ1ZmZlci5pc1ZpZXcoVikgfHwgViBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKF8oXCJpcyBub3QgYW4gQXJyYXlCdWZmZXIgb2JqZWN0IG9yIGEgdmlldyBvbiBvbmVcIiwgb3B0cykpO1xuICAgIH1cblxuICAgIHJldHVybiBWO1xufTtcblxuZXhwb3J0cy5ET01UaW1lU3RhbXAgPSBleHBvcnRzW1widW5zaWduZWQgbG9uZyBsb25nXCJdO1xuXG5leHBvcnRzLkZ1bmN0aW9uID0gY29udmVydENhbGxiYWNrRnVuY3Rpb247XG5cbmV4cG9ydHMuVm9pZEZ1bmN0aW9uID0gY29udmVydENhbGxiYWNrRnVuY3Rpb247XG4iXX0=